// Do not modify this page directly; instead build from https://github.com/RopeWiki/commonjs
$("head").prepend('<meta name="viewport" content="width=320, initial-scale=1.0">');var RWServerUrl="http://luca.ropewiki.com";function setCookie(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="expires="+o.toUTCString();document.cookie=e+"="+t+"; path=/ ; "+i}function getCookie(e,t){for(var n=e+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){for(var a=o[i];" "==a.charAt(0);)a=a.substring(1);if(-1!=a.indexOf(n))return a.substring(n.length,a.length)}return void 0!==t?t:""}function checkregname(){var e,t,n=window.location.href.toString().split("?"),o=urldecode(getCookie("regnameval"));n.length<2&&""!=o&&("Beta"!=(t=(e=n[0].split("/"))[e.length-1])&&"Conditions"!=t&&"conditions.html"!=t||(window.location.href=n+"?region="+urlencode(o)))}function geturl(e){var t="http://ropewiki.com",n="http://www.ropewiki.com";return window.location.href.toString().substr(0,n.length)==n&&e.substr(0,t.length)==t?n+e.substr(t.length):e}function Distance(e,t){var n=Math,o=n.PI/180,i=e.lat*o,a=t.lat*o,l=i-a,r=e.lng*o-t.lng*o;return 6378.137*(2*n.asin(n.sqrt(n.pow(n.sin(l/2),2)+n.cos(i)*n.cos(a)*n.pow(n.sin(r/2),2))))*km2mi}checkregname();var km2mi=.621371,mi2ft=5280,m2ft=3.28084;function xdeg(e){return Math.round(Math.atan(e/100)*(180/Math.PI),1)}function ftxmi(e){return metric?Math.round(e/m2ft*km2mi).toLocaleString()+"m/km":Math.round(e).toLocaleString()+"ft/mi"}function ft(e,t){return isNaN(e)?"":metric?Math.round(e/m2ft).toLocaleString()+(t?"&nbsp;":"")+"m":Math.round(e).toLocaleString()+(t?"&nbsp;":"")+"ft"}function mi(e,t){return isNaN(e)?"":metric?(Math.round(e/km2mi*10)/10).toLocaleString()+(t?"&nbsp;":"")+"km":(Math.round(10*e)/10).toLocaleString()+(t?"&nbsp;":"")+"mi"}function rap(e,t){return isNaN(e)?"":e+(t?"&nbsp;":"")+"r"}function uconv(e,t){if(null==e||""==e)return"";var n=e.split("↕");return 0<n.length&&(n[0]=t(parseFloat(n[0]),0<e.indexOf("&nbsp;"))),1<n.length&&(n[1]=ft(parseFloat(n[1]),0<e.indexOf("&nbsp;"))),n.join(" ↕")}function acaconv(e,t){var n=e.indexOf(")");if(n<0)return e;for(var o=e.indexOf("*")+1;o<n&&!("1"<=e.charAt(o)&&e.charAt(o)<="4");)++o;3<=o&&"<i>"==e.substr(o-3,3)&&(o-=3);var i=e.substr(o,n-o).split("(");if(i.length<2)return e;var a=i[french?1:0].trim();return t&&(a+=" ("+i[french?0:1].trim()+")"),e.substr(0,o)+a+e.substr(n+1)}function smallstyle(){WebViewStyle(),$("#p-logo a").attr("href","#")}var skinuser="";function loadSkin(){for(var e=document.getElementsByClassName("toption"),t=0;t<e.length;++t)e[t].style.display="block";var n=urldecode(getCookie("skinconfig")),o=document.getElementById("skinconfig");if(null!=o&&setCookie("skinconfig",urlencode(n=urldecode(o.innerHTML))),""!=n){var i=n.split(",");skinuser=i[0],null!=(o=document.getElementById("skinuser"))&&""==o.innerHTML&&""!=skinuser&&(0<=(i=window.location.href).indexOf("?")?i+="&":i+="?",document.body.style.display="none",window.location.href=i+"skinuser="+skinuser),1<i.length&&""!=i[1]&&(null!=(o=document.body)&&(o.style.backgroundColor=i[1]),null!=(o=document.getElementById("mw-page-base"))&&(o.style.backgroundColor=i[1],o.style.backgroundImage="none")),2<i.length&&""!=i[2]&&(l=i[2].split("|"),null!=(o=document.getElementById("p-logo"))&&(o.innerHTML='<a href="'+l[0]+'"><img src="'+l[1]+'"/></a>'));for(var a=3;a<i.length;++a){for(var l,r="",s=(l=i[a].split("*"))[0].split("|"),t=1;t<l.length;++t){var c=l[t].split("|");r+='<li id="n-'+t+'"><a href="'+c[0]+'">'+c[1]+"</a></li>"}null!=(o=document.getElementById(s[0]))&&(o.innerHTML=""!=r?"<h3>"+s[1]+'</h3><div class="body"><ul>'+r+"</ul></div>":"")}}}var gtrans=null,gtrans2="x",glist,genlist;function textTranslation(e,t,n){if(!glist)return e;t=t||"",n=n||"";for(var o=0;o<glist.length;++o)e=e.replace(genlist[o],t+glist[o]+n);return e}function loadTranslation(){if((gtrans=3<=(gtrans=getCookie("googtrans").split("/")).length?gtrans[2]:null)!=gtrans2){gtrans2=gtrans;var e=["en,Introduction,Approach,Descent,Exit,Red tape,Background,Credits,Beta sites,Trip reports and media,Time,Raps,Shuttle,Start,End,Road,Parking,(Upper),(Middle),(Lower)","es,Descripci�n,Aproximaci�n,Descenso,Retorno,Regulaciones,Historia,Cr�ditos,Referencias,Informes del recorrido y fotos,Horario,R�peles,Combinaci�n,Inicio,Final,Carretera,Parking,(Superior),(Intermedio),(Inferior)","pt,Descri��o,Aproxima��o,Descida,Retorno,Regulamentos,Hist�ria,Cr�ditos,Refer�ncias,Relat�rios de viagens e fotos,Tempos,Rapeis,Combina��o,Entrada,Sa�da,Estrada,Parking,(Superior),(Intermedi�rio),(Inferior)","it,Descrizione,Avvicinamento,Discesa,Rientro,Normativa,Storia,Crediti,Siti web,Report di viaggio e foto,Tempi,Calate,Navetta,Entrata,Uscita,Strada,Parking,(Superiore),(Intermedio),(Inferiore)","fr,Description,Approche,Descente,Retour,R�glements,Historique,Cr�dits,Sites internet,Rapports de voyage et photos,Temps,Rappels,Navette,Depart,Arrivee,Route,Parking,(Sup�rieur),(Interm�diaire),(Inf�rieur)","de,Einleitung,Zustieg,Zejscie,R�ckweg,Vorschriften,Hintergrund,Credits,Weblinks,Reiseberichte und fotos,Zeit,Abseilen,Schiffchen,Einleitung,Ausstieg,Strasse,Parking,(H�her),(Intermedi�r),(Untere)","ca,Descripci�,Aproximaci�,Descens,Retorn,Regulacions,Hist�ria,Cr�dits,Refer�ncies,Informes del recorregut i fotos,Horari,R�pels,Combinaci�,Inici,Final,Carretera,Parking,(Superior),(Intermedi),(Inferior)"];glist=null,genlist=(e[0].substr(3)+e[0].substr(2).toLowerCase()).split(",");for(var t=0;t<e.length;++t)if(e[t].substr(0,2)==gtrans){glist=(e[t].substr(3)+e[t].substr(2).toLowerCase()).split(",");break}for(var n=document.getElementsByClassName("ctranslate"),o=0;o<n.length;o++){var i=n[o],a=i.innerHTML;i.oinnerHTML?a=i.oinnerHTML:i.oinnerHTML=a,i.innerHTML=textTranslation(a,'<span class="notranslate"> '," </span>")}for(var l=document.getElementsByClassName("external"),o=0;o<l.length;o++){var r,s,c,m,d,p="ext=.rw",g=l[o];g.href&&((r=g.href).indexOf("translate.google.com")<0&&r.indexOf(p)<0||(a=g.innerHTML,g.ohref?(r=g.ohref,a=g.oinnerHTML):(g.ohref=r,g.oinnerHTML=a),0<=r.indexOf(p)?g.href=r=rwlink(r,""):(d=r.indexOf("&u=http"))<0||(s=r.substr(d+3),c="en",m="auto",0<=(d=r.indexOf("&sl="))&&"au"==(m=r.substr(d+4,2))&&(m="auto"),gtrans&&(c=gtrans),m!=c?(g.style.display="inline",g.href="http://translate.google.com/translate?&hl="+c+"&sl="+m+"&tl="+c+"&u="+s):g.style.display="none")))}}}loadSkin();var url=window.location.href.toString(),debug=0<=url.indexOf("debug="),url;"#"==url[url.length-3]&&(setCookie("metric","on",3600),setCookie("french","on",3600),setCookie("country","on",3600),setCookie("googtrans","/en/"+url.substr(url.length-2),3600)),getCookie("country")||(url="http://freegeoip.net/json/",$.getJSON(geturl(url),function(e){e&&e.country_code&&(setCookie("country","on",3600),console.log("country:"+e.country_code),"US"!=e.country_code&&(setCookie("metric","on",3600),setCookie("french","on",3600),window.location.reload()))}));var metric=getCookie("metric"),french=getCookie("french"),urlcheckbox=getCookie("urlcheckbox"),weather=getCookie("weather"),watershed=getCookie("watershed"),sheet=document.createElement("style");sheet.id="french",sheet.innerHTML=french?" .uaca0 { display: none ; }":" .uaca1 { display: none ; }",document.body&&document.body.appendChild(sheet);var starrate=getCookie("starrate");0<=window.location.href.toString().indexOf("starratechk=")&&(starrate=!0);var labels=getCookie("labels"),slideshowchk=getCookie("slideshowchk","undefined");function toggleMetric(e){setCookie("metric",(metric=!metric)?"on":"",3600),document.body.style.cursor="wait",window.location.reload()}function toggleFrench(e){setCookie("french",(french=!french)?"on":"",3600),document.body.style.cursor="wait",window.location.reload()}function toggleUrlcheckbox(e){setCookie("urlcheckbox",urlcheckbox=setparam(urlcheckbox,e.id,e.checked?"on":"off"),3600),gtrans2="x",loadTranslation()}function togglewchk(varname){var varval=!eval(varname);setCookie(varname,varval?"on":"",3600),document.body.style.cursor="wait",window.location.reload()}function toggleStarrate(e){setCookie("starrate",(starrate=!starrate)?"on":"",3600),starrate?LoadStars():(document.body.style.cursor="wait",window.location.reload())}function toggleLabels(e){setCookie("labels",(labels=!labels)?"on":"",3600),document.body.style.cursor="wait",window.location.reload()}function toggleSlideshow(e){slideshowchk=void 0!==e?e:!slideshowchk,setCookie("slideshowchk",slideshowchk?"on":"",3600);for(var t=document.getElementsByClassName("slideshow"),n=0;n<t.length;n++)t[n].style.display=slideshowchk?"":"none";for(t=document.getElementsByClassName("slideshowschk"),n=0;n<t.length;n++)t[n].checked=slideshowchk;slideshowchk?(document.body.style.zIndex=0,document.body.style.zoom=1):(document.body.style.zIndex=1,document.body.style.zoom=1.0000001)}function noextraction(e){return 0<=e.indexOf("roadtripryan.com")}function getdomain(e){var t=e.split("http");if(e.length<=0)return e;var n=t[t.length-1].split("/");return n.length<=2?e:n[2]}"undefined"==slideshowchk&&(slideshowchk="on"),slideshowchk=""!=slideshowchk;var lastlinks=[];function loadSource(e,t){var n=document.getElementById("myddOptsDiv"),o=document.getElementById("myddOptsText");if(o&&n){n.style.display="none",o.innerHTML=t,gxml.overlayman.Hide();var i=0<=e.indexOf("ropewiki.com"),a=e;i||(a="http://d5a.net/rwr?gpx=off&filename=tmp&kmlnfx&kmlx="+a);var l=document.getElementById("kmlfilep");l&&(l.innerHTML=a),0<=lastlinks.indexOf(e)?gxml.overlayman.Show(e):(gxml.load(a,e),lastlinks.push(e));for(var r=noextraction(e),s=["rw","ex","noex"],c=[i,!i&&!r,!i&&r],m=0;m<s.length;++m)for(var d=document.getElementsByClassName("display"+s[m]),p=0;p<d.length;++p)d[p].style.display=c[m]?"block":"none";for(var g=["ex","noex"],m=0;m<g.length;++m)for(d=document.getElementsByClassName("display"+g[m]),p=0;p<d.length;p++)for(var u=d[p].getElementsByTagName("A"),h=0;h<u.length;++h){var f,v,y,w,k=u[h].href;0<k.indexOf("caltopo.com")?(f="kmlx%253D",v="ext%253D.kml",y=k.indexOf(f),w=k.indexOf(v,y+1),u[h].href=k.substr(0,y+f.length)+urlencode(e+"&")+k.substr(w)):0<k.indexOf("d5a.net")?(f="kmlx%3D",v="ext%3D.kml",y=k.indexOf(f),w=k.indexOf(v,y+1),u[h].href=k.substr(0,y+f.length)+e+"&"+k.substr(w)):k.indexOf("/Map?pagename=")<0&&(u[h].href=e,u[h].innerHTML=t)}}}var lastfrom="",lastto="",geoelevationService;function displaydirectionsto(e){lastto=e.join(),window.open("http://maps.google.com/?output=classic&saddr="+lastfrom+"&daddr="+lastto,"_blank")}function displaydirectionsfrom(e){lastfrom=e.join(),""==lastto?alert("Click on a 'Directions To' link to get the full route"):window.open("http://maps.google.com/?output=classic&saddr="+lastfrom+"&daddr="+lastto,"_blank")}function displaycoordenates(e){window.prompt("Copy to clipboard with Ctrl+C, Cmd-C, Click&Hold or other methods.",e.join())}function displaydirections(e,t,n){var o="<div><i>";return o+='<a href="javascript:displaydirectionsto(['+e+","+t+']);">Directions To</a> - <a href="javascript:displaydirectionsfrom(['+e+","+t+']);">Directions From</a>',n&&(o+=n),o+="</i></div>"}function displaylocation(e,t,n){var o='<div class="textselect">',e=parseFloat(e),t=parseFloat(t),i=Math.round(1e5*e)/1e5+","+Math.round(1e5*t)/1e5;return o+='Coords: <a href="http://maps.google.com/maps?q=loc:'+i+'" target="_blank">'+i+"</a>",n&&(o+=n),o+="</div>"}function setfield(e){var t=$("#setfieldtarget input");0<t.length&&e&&(t[0].value=e.innerHTML)}function getgeoelevation(e,o,i,a){var t;(geoelevationService=geoelevationService||new google.maps.ElevationService)&&e&&((t=[]).push(e),geoelevationService.getElevationForLocations({locations:t},function(e){var t,n;e[0]&&(i=i||"",a=a||"",t=e[0].elevation*m2ft,(n=document.getElementById(o))&&(n.innerHTML=i+'<span class="notranslate">'+ft(t)+"</span>"+a))}))}function getgeocode(e,t,l){var n="http://maps.googleapis.com/maps/api/geocode/json?latlng="+e.toString().trim()+","+t.toString().trim();$.getJSON(geturl(n),function(e){if(e&&e.results){for(var t=[],n=0;n<e.results.length;++n)for(var o=0;o<e.results[n].address_components.length;++o){var i=e.results[n].address_components[o];0<=i.types.indexOf("political")&&t.indexOf(i.long_name)<0&&t.push(i.long_name)}var a=document.getElementById(l);a&&(a.innerHTML="Geocode:"+t.join(", "))}})}function suggestregion(){var e=document.getElementsByName("Canyon[Coordinates]");if(0<e.length&&e[0].value)return suggestregioncoords(e[0].value);var t=document.getElementsByName("Canyon[Geolocation]");return 0<t.length&&t[0].value?suggestregiongeocode(t[0].value):void 0}function suggestregiongeocode(e){var t="https://maps.googleapis.com/maps/api/geocode/json?address="+e;$.getJSON(geturl(t),function(e){if(e&&e.results)for(var t=0;t<e.results.length;++t)if(e.results[t].geometry&&e.results[t].geometry.location&&e.results[t].geometry.location.lat&&e.results[t].geometry.location.lng)return void suggestregioncoords(e.results[t].geometry.location.lat+","+e.results[t].geometry.location.lng)})}function suggestregioncoords(s){var e="http://ropewiki.com/api.php?action=ask&format=json&query=[[Category:Canyons]][[Has coordinates::"+(s=s.split(" ").join(""))+" (50000)]]|%3FHas_coordinates|%3FLocated_in_region|limit=1000";$.getJSON(geturl(e),function(e){for(var t=getrwlist(e),n=s.split(","),o={lat:parseFloat(n[0]),lng:parseFloat(n[1])},i=0;i<t.length;++i)t[i].dist=Distance(o,t[i].location);t.sort(function(e,t){return e.dist-t.dist});for(var a=[],i=1;i<t.length&&a.length<3;++i)a.indexOf(t[i].region)<0&&a.push(t[i].region);var l=document.getElementById("suggestednearby");l&&(l.innerHTML="Nearby:"+a.join(", "));var r=document.getElementsByName("Canyon[Region]");r&&0<r.length&&0<a.length&&(r[0].value=a[0])})}var starlist=["http://ropewiki.com/images/9/9d/GoldStar0.png","http://ropewiki.com/images/8/86/GoldStar1.png","http://ropewiki.com/images/f/fd/GoldStar2.png","http://ropewiki.com/images/8/8d/GoldStar3.png","http://ropewiki.com/images/4/41/GoldStar4.png"];function GetStar(e,t){return'<img width="'+t+'px" height="'+t+'px" src="'+starlist[4]+'"/>'}function GetStarFraction(e){return.875<=e?4:.625<=e?3:.375<=e?2:.125<=e?1:0}function GetStars(e,t,n){for(var o='<span style="white-space: nowrap;">',i=0;i<5;++i)o+='<img width="'+n+'px" height="'+n+'px" src="'+starlist[GetStarFraction(e)]+'"/>',--e;return 0<t&&(o+='<span class="starsub">'+t+"</span>"),o+="</span>"}function GetStarsVote(e,t,n,o){var i='<span class="starRate" style="white-space: nowrap;">',a=["Delete","Not worth doing","Worthwhile","Ok","Great","Among the best"];if(!document.getElementById("curuser"))for(var l=0;l<=5;++l)a[l]="Log in to rate";for(l=1;l<=5;++l)i+='<b id="'+l+'" class="starRate'+GetStarFraction(e)+'" style="cursor:pointer" onclick="StarVote(this)"><span class="starText starvText">'+a[l]+"</span></b>",--e;return 0<t?i+='<b id="0" class="starx starsub" style="color:red;cursor:pointer;" onclick="StarVote(this)">X<span class="starText starvText">'+a[0]+"</span></b>":0<n&&(i+='<span class="starsub">'+n+"</span>"),i+="</span>"}function GetStarsId(e){for(var t=e.parentNode;null!=t&&"TR"!=t.nodeName;)t=t.parentNode;if(null==t)return null;var n=t.getElementsByTagName("A");return n&&n[0]?n[0].innerHTML:null}function StarVote(e){var t=e.id,n=GetStarsId(e),o=document.getElementById("curuser");if(t&&n&&o){var i=o.innerHTML,a=document.createElement("IFRAME"),l="Votes:"+n+"/"+i;"0"==t&&(i=t=""),a.src="http://ropewiki.com/api.php?action=sfautoedit&form=Page_rating&target="+l+"&query=Page_rating[Page]="+n+"%26Page_rating[Rating]="+t+"%26Page_rating[User]="+i,a.style.display="none",document.body.appendChild(a);for(var r=e.parentNode;null!=r&&r.className.indexOf("starv")<0;)r=r.parentNode;r&&(r.innerHTML=GetStarsVote(t,t,-1,16),r.className="starv votedrow")}}function LoadStars(){for(var e=window.location.href.toString(),t=starrate||0<e.indexOf("onlyuser=")||0<e.indexOf("starratechk="),n=document.getElementsByClassName("starv"),o=0;o<n.length;o++){var i,a,l,r,s,c=void 0===n[o].starsvstr?n[o].starsvstr=n[o].innerHTML:n[o].starsvstr,m=c.split("*");m.length<2||(i=parseFloat(m[0]),null!=(a=GetStarsId(n[o]))?(r=l=-1,r=parseFloat(m[1]),1<(s=m[1].split("#")).length&&(l=parseInt(s[1])),t&&0<r&&(i=r,l=0),starrate?(n[o].innerHTML=GetStarsVote(i,r,l,16),0<r&&(n[o].className="starv votedrow")):(n[o].innerHTML='<a href="http://ropewiki.com/List_ratings?location='+a+'">'+GetStars(i,l,16)+"</a>",n[o].title=i+"*"+(l<=0?"":" ("+l+" ratings)"),0<r&&(n[o].className="starv votedsub"))):n[o].innerHTML=GetStars(i,0,16))}}function loadcredits(e,v,y){if(document.getElementById(y)){var w=0,k=[],b=geturl("http://ropewiki.com/api.php?format=json&action=query&prop=revisions&rvexcludeuser=BetaRobot&redirects=&continue=");switch(v){case"P":b+="&rvprop=user|size&titles="+e+"&rvlimit=max&rvdir=newer";break;case"K":b+="&rvprop=user|comment&titles=File:"+e+".kml&rvlimit=max&rvdir=newer";break;case"J":b="http://ropewiki.com/api.php?format=json&action=query&titles=File:"+e+" Banner.jpg&prop=imageinfo&iiprop=user|comment"}$.getJSON(b,function d(p){var g=[],u="Barranquismo.net",e=document.getElementsByClassName("barranquismonet");for(i=0;i<e.length;++i)g.push(e[i].innerHTML);var h="addcredit",f=[],t=document.getElementsByClassName(h);for(i=0;i<t.length;++i)f.push(t[i].innerHTML);$.each(p.query.pages,function(e,t){var n=t.revisions;if(null!=(n=n||t.imageinfo)&&null!=n.length)for(var o,e=0;e<n.length;++e)0<g.length&&"BetaRobot2"==n[e].user&&(n[e].user=u),0<f.length&&"BetaRobot2"==n[e].user&&(n[e].user=h),0==g.length&&0<=n[e].user.search(u)||("J"!=v||!n[e].comment||1<(o=n[e].comment.split(" by ")).length&&(n[e].user=o[1],n[e].comment=""),0<=n[e].user.search("Robot")||("J"==v&&k.splice(0,k.length),(r=function(e){for(var t=0;t<k.length;++t)if(k[t].user==e)return t;return-1}(n[e].user))<0&&(k.push({user:n[e].user,size:0}),r=k.length-1),null!=n[e].size&&(k[r].size+=n[e].size-w,w=n[e].size),null!=n[e].comment&&(k[r].comment=n[e].comment)));if(void 0===p.continue){var i,l="";if(0==w)m(k,w);else{for(var a=0,r=0;r<k.length;++r)0<k[r].size&&(a+=k[r].size),k[r].size<0&&k.splice(r--,1);for(var s=[],c=[],r=0;r<k.length;++r)0==r||0==a||.05<k[r].size/a?s.push(k[r]):c.push(k[r]);m(s,1<s.length?a:0),0<c.length&&(l+=" with minor contributions by ",m(c,0))}!l||(i=document.getElementById(y))&&(i.innerHTML=l)}else $.getJSON(b+"&rvcontinue="+p.continue.rvcontinue,d);function m(e,t){if(0!=e.length){for(var n,o=0;o<e.length;++o)e[o].user==h?l+=f.join(" & ").split("(").join("[").split(")").join("]"):0<e[o].user.indexOf("http")?(n=e[o].user.split("http"),l+=n[0].link("http"+n[1])):l+=e[o].user.link("http://ropewiki.com/User:"+e[o].user),e[o].user==u?l+="["+g.join(", ")+"]":0<t&&(l+=" ("+Math.round(e[o].size/t*100)+"%)"),o<e.length-1&&(l+=o<e.length-2?", ":" & ");var i,a=e[e.length-1].comment;null!=a&&0<a.indexOf("[[File:")&&(a=0<(i=a.indexOf(": "))?a.substr(i+2):""),null!=a&&""!=a&&(l+=" ("+a+")")}}})})}}function aref(e,t,n,o){return void 0===n&&(n=""),void 0===o&&(o=""),'<A href="'+e+'" title="'+n+'" '+o+">"+t+"</A>"}function getLinkLang(e){for(var t=1;t<3&&e;++t)if((e=e.previousSibling)&&"IMG"==e.nodeName){var n,o,i=e.src;if(0<(n=i.indexOf("Rwl_"))&&0<(o=i.indexOf(".",n)))return i.substr(n+4,o-n-4)}return null}function popupwin(e,t,n){return void 0===t&&(t=600),void 0===n&&(n=500),"java"==e.substr(0,4)?e:(0<=e.indexOf("ropewiki")&&(e+=(0<=e.indexOf("?")?"&":"?")+"action=render"),"javascript:popupwindow('"+e+"',"+t+","+n+");")}function popupwindow(e,t,n){window.open(e,"_blank","width="+t+",height="+n+",scrollbars=yes,menubar=yes,resizable=yes,toolbar=yes")}function rwlink(e,t){for(var n="ext=.rw",o=urlcheckbox,i=t.split("&"),a=0;a<i.length;++a){var l=i[a].split("=");2==l.length&&(o=setparam(o,l[0],l[1]))}return metric&&(e=e.replace(n,"metric=on&"+n)),french&&(e=e.replace(n,"french=on&"+n)),gtrans&&(e=e.replace(n,"gtrans="+gtrans+"&"+n)),o&&(e=e.replace("&"+n,o+"&"+n)),o.indexOf("smallscreen=on")<0&&(e=e.replace(n,"docwidth="+$(window).width()+"&"+n)),e}var locdist="locdist=";function nearbyselect(e){var t=e.parentNode.getElementsByTagName("A")[0].href,n=t.indexOf(locdist),o=t.substring(0,n)+locdist+e.value;document.body.style.cursor="wait",window.location.href=o}function pdfselect(e){var t,n,o,i,a,l,r="",s=15,c=RWServerUrl+"/rwr?",m=document.getElementById("idcredits");!m||(t=m.innerHTML)&&""!=t&&(t=urldecode(t).split(" ").join("_"),n="","P"==(o=e.value)?(r=c+"filename="+(t+".pdf")+"&pdfx="+t+"&ext=.rw",n="summary=off"):"PM"==o?(r=c+"filename="+(t+"_MAP.pdf")+"&pdfx=Map?pagename="+t+"&ext=.rw",n="summary=off"):"KM"==o?(r=$("#kmlfilep").html(),s=1):"GM"==o?(r=$("#kmlfilep").html().split("gpx%3Doff").join("gpx%3Don"),s=1):"ZPM"==o?(r=c+"filename="+(t+".zip")+"&zipx="+t+"&ext=.rw",n="bslinks=off&trlinks=off&summary=off"):"ZALL"==o?(r=c+"filename="+(t+"+.zip")+"&zipx="+t+"&ext=.rw",n="bslinks=on&summary=off"):"S"==o&&(r="http://ropewiki.com/PDFDownload?pagename="+t+"&ext=.rw"),""!=(r=rwlink(r,n))&&(e.value="",e.blur(),i=!0,a=0,setCookie("rwfilename",""),l=setInterval(function(){i=!i,a++,$("#ptext").css("opacity",i?"1.0":"0.5"),(""!=getCookie("rwfilename","")||s<a)&&(clearInterval(l),$("#ptext").css("display","none"))},1e3),$("#ptext").css("display","inline"),window.location.href=r))}function getDomainFaviconURL(e){var t=e.match(/(\w+):\/\/([^/:]+)(:\d*)?([^# ]*)/),t=RegExp.$2;new Image;return"http://www.google.com/s2/favicons?domain="+t}function openfavlinks(){var e="",t=document.getElementsByClassName("favlinks");for(i=0;i<t.length;++i){var n=t[i].getElementsByTagName("A")[0].href;e+='<hr><h2>From <a href="'+n+'">'+n+'</a>:</h2><iframe src="'+n+'" frameborder="0" width="100%" min-height="3000px" style="font-size:smaller;"></iframe>'}var o,a=document.getElementById("allfavlinks");a||((a=document.createElement("DIV")).id="allfavlinks",null==(o=document.getElementById("content"))&&(o=document.body),o.appendChild(a)),a&&(a.innerHTML=e)}function loadUserInterface(document){$("title").addClass("notranslate"),$(".firstHeading span").addClass("notranslate"),$("#searchform").addClass("notranslate"),$(".suggestions").addClass("notranslate"),$(".mw-headline").addClass("ctranslate"),$(".toctext").addClass("ctranslate");for(var colgroup=document.getElementsByClassName("colgroup"),i=0;i<colgroup.length;++i){var table=colgroup[i],list=table.id.split(".");findtag(table.childNodes,"TR",function(e){for(var t=0,n=e.childNodes,o=0;o<n.length&&t<list.length;++o){var i,a=n[o];"TD"==a.nodeName&&(0<(i=list[t]).length&&0==a.getElementsByClassName(i).length&&(a.className+=" "+i),++t)}})}for(var sections=document.getElementsByName("_section[Background]"),i=0;i<sections.length;i++){var text=sections[i].innerHTML;"==Background=="==text.trim().split(" ").join()&&(sections[i].innerHTML="")}for(var jslink=document.getElementsByClassName("jslink"),i=0;i<jslink.length;i++)jslink[i].innerHTML='<a href="javascript:'+jslink[i].id+'();">'+jslink[i].innerHTML+"</a>";for(var tablinks=document.getElementsByClassName("tablinks"),i=0;i<tablinks.length;i++)for(var links=tablinks[i].getElementsByTagName("A"),j=0;j<links.length;j++){var link=links[j];link.target="tabIframe2"}var tabmain=document.getElementsByClassName("tabMain"),tablink1;0<tablinks.length&&0<tabmain.length&&(tablink1=tablinks[0].getElementsByTagName("A"),0<tablink1.length&&(tabmain[0].innerHTML='<div class="tabIframeWrapper"><iframe class="tabContent" name="tabIframe2" src="'+tablink1[0].href+'" marginheight="8" marginwidth="8" frameborder="0"></iframe></div>'));for(var nofollow=document.getElementsByClassName("nofollow"),i=0;i<nofollow.length;i++)for(var links=nofollow[i].getElementsByTagName("A"),j=0;j<links.length;j++){var link=links[j];link.rel="nofollow"}for(var popups=document.getElementsByClassName("popwin"),i=0;i<popups.length;i++)for(var links=popups[i].getElementsByTagName("A"),j=0;j<links.length;j++){var link=links[j],url=link.href;link.href=popupwin(url)}for(var popups=document.getElementsByClassName("pops"),i=0;i<popups.length;i++)for(var links=popups[i].getElementsByTagName("A"),j=0;j<links.length;j++){var link=links[j];link.target="_blank"}for(var elems=document.getElementsByClassName("popforms"),i=0;i<elems.length;i++)for(var links=elems[i].getElementsByTagName("A"),l=0;l<links.length;++l){var href=links[l].attributes.href,str;href&&(str=href.value,str=str.replace("Special:FormEdit/File","Special:Upload"),href.value=str)}for(var setfield=$("ul.setfield"),i=0;i<setfield.length;i++){for(var sp=setfield[i].innerHTML.split("<li>"),j=1;j<sp.length;++j){var spj=sp[j].split("<"),name=spj[0].trim();spj[0]='<span onclick="setfield(this)" style="cursor:pointer;" >'+name+"</span>",sp[j]=spj.join("<")}setfield[i].innerHTML=sp.join("<li>")}for(var setfield=$("ul.regioncount"),i=0;i<setfield.length;i++){for(var sp=setfield[i].innerHTML.split("<li>"),j=1;j<sp.length;++j){var len=sp[j].indexOf("<",sp[j].indexOf("</a")+1),text=sp[j].substring(0,len).trim().replace("(i)",'<hr id="vri">');text='<span class="regioncount">'+text+"</span>",sp[j]=text+sp[j].substring(len)}setfield[i].innerHTML=sp.join("<li>")}for(var readmore=document.getElementsByClassName("readmore"),i=0;i<readmore.length;i++){var text=readmore[i].innerHTML;readmore[i].innerHTML='<a href="#overviewstart" class="readmorebutton">'+text+"</a>"}LoadStars();for(var months=document.getElementsByClassName("monthv"),i=0;i<months.length;i++){var str=months[i].innerHTML;if(0!=str.length){for(var out='<table class="wikitable bst mbst nostranslate"><tr>',s=0;s<str.length;++s)switch(str.charAt(s)){case",":out+='<td class="bss"></td>';break;case"X":out+='<td class="bsg"></td>';break;case"x":out+='<td class="bsy"></td>';break;case".":out+="<td></td>"}out+="</tr></table>",months[i].innerHTML=out,months[i].style.display="block"}}if(metric){for(var texts=document.getElementsByClassName("uft"),i=0;i<texts.length;i++)texts[i].innerHTML=uconv(texts[i].innerHTML,ft);texts=document.getElementsByClassName("umi");for(var i=0;i<texts.length;i++)texts[i].innerHTML=uconv(texts[i].innerHTML,mi);texts=document.getElementsByClassName("urap");for(var i=0;i<texts.length;i++)texts[i].innerHTML=uconv(texts[i].innerHTML,rap)}for(var texts=document.getElementsByClassName("uaca"),i=0;i<texts.length;i++)texts[i].innerHTML=acaconv(texts[i].innerHTML);for(var texts=document.getElementsByClassName("uacamore"),i=0;i<texts.length;i++)texts[i].innerHTML=acaconv(texts[i].innerHTML,!0);elem=document.getElementsByClassName("urlcheckbox");for(var i=0;i<elem.length;i++){var on=getparam(urlcheckbox,elem[i].id,elem[i].innerHTML);elem[i].className+=" notranslate",elem[i].innerHTML='<input id="'+elem[i].id+'" class="gmnoprint" type="checkbox" onclick="toggleUrlcheckbox(this)" '+("on"==on?"checked":"")+">"}elem=document.getElementsByClassName("uchk");for(var i=0;i<elem.length;i++)elem[i].className+=" notranslate",elem[i].innerHTML='<label><input class="gmnoprint" type="checkbox" onclick="toggleMetric()" '+(metric?"checked":"")+">Metric</label>";elem=document.getElementsByClassName("fchk");for(var i=0;i<elem.length;i++){elem[i].className+=" notranslate";var label=elem[i].innerHTML;elem[i].innerHTML='<label><input class="gmnoprint" type="checkbox" onclick="toggleFrench()" '+(french?"checked":"")+">"+label+"</label>"}elem=document.getElementsByClassName("wchk");for(var i=0;i<elem.length;i++){var id=elem[i].id,label=elem[i].innerHTML;elem[i].innerHTML='<label><input class="gmnoprint" type="checkbox" onclick="togglewchk(\''+id+"')\" "+(eval(id)?"checked":"")+">"+label+"</label>"}elem=document.getElementsByClassName("schk");for(var i=0;i<elem.length;i++){elem[i].className+=" notranslate";var label=elem[i].innerHTML;elem[i].innerHTML='<label><input class="gmnoprint" type="checkbox" onclick="toggleStarrate()" '+(starrate?"checked":"")+">"+label+"</label>"}elem=document.getElementsByClassName("schkon");for(var i=0;i<elem.length;i++)elem[i].style.display=starrate?"table-row":"none";elem=document.getElementsByClassName("external");for(var i=0;i<elem.length;i++){var link=elem[i],from=getLinkLang(link),to,ourl;from&&(to="en",ourl=link.href,ourl.replace("&","%26"),div=document.createElement("SPAN"),div.innerHTML=' <a rel="nofollow" class="external text" style="display:none" href="http://translate.google.com/translate?&hl='+to+"&sl="+from+"&tl="+to+"&u="+ourl+'">[Translated]</a>',link.parentNode.insertBefore(div,link.nextSibling))}var fbuser=document.getElementById("fbuser");fbuser&&(fbuser.innerHTML='<input class="submitoff" type="submit" onclick="fbusersearch()" value="'+fbuser.innerHTML+'">');var hdr=document.getElementById("firstHeading"),pdf=document.getElementById("idcredits"),kml=document.getElementById("kmlmapdisplay"),edit=0<window.location.href.toString().indexOf("&action="),text,div;hdr&&pdf&&kml&&!edit&&(text=' <select class="notranslate" style="width:27px;height:32px;background-image:url(http://ropewiki.com/images/a/ad/DownIcon.png);" id="pdfselect" value="" onchange="pdfselect(this)">',text+='<option selected disabled hidden style="display: none" value=""></option>',text+='<option value="P">PDF: Page</option>',text+='<option value="PM">PDF: Map</option><option value="KM">KML: Map</option><option value="GM">GPX: Map</option>',text+='<option value="ZPM">ZIP: Page + Maps</option><option value="ZALL">ZIP: P + M + Links</option>',text+='<option value="S">*: Settings</option></select>',text+='<img id="ptext" height="32" style="display:none;vertical-align:top" src="http://ropewiki.com/extensions/SemanticForms/skins/loading.gif"/>',div=document.createElement("SPAN"),div.className="gmnoprint",div.title="Download",div.id="pdfbutton",div.innerHTML=text,hdr.appendChild(div));var creditsline=document.getElementById("idcredits"),pagename;creditsline&&(pagename=creditsline.innerHTML,loadcredits(pagename,"K","Kcredits"),loadcredits(pagename,"P","Pcredits"),loadcredits(pagename,"J","Jcredits"));var referencepic=document.getElementById("referencepic");if(referencepic){var approach=document.getElementById("Approach");if(approach){for(var h2=approach.parentNode;null!=h2&&"H2"!=h2.nodeName;)h2=h2.parentNode;null!=h2&&(h2.parentNode.insertBefore(referencepic,h2),referencepic.style.display="block")}}if(elem=document.getElementsByClassName("titleuser"),0<elem.length){for(var floatdiv="",i=0,src;i<elem.length;i++){var str=elem[i].innerHTML.split(","),img='<img src="'+str[0]+'"/>';1<str.length?floatdiv+='<a href="'+str[1]+'" title="Visit the main page">'+img+"</a>":floatdiv+=img}elem=document.getElementById("firstHeading"),elem&&(src=elem.innerHTML,elem.innerHTML='<div style="float:right;clear:right">'+floatdiv+"</div>"+src)}var wdir=1,wval=255,wstep=128,wtimer=setInterval(function(){255<(wval+=wdir)&&(wval=255,wdir=-wstep),wval<239&&(wval=239,wdir=wstep);for(var e=document.getElementsByClassName("rwwarning"),t="#"+((wval<<16)+(wval<<8)).toString(16),n=0;n<e.length;++n){e[n].style.backgroundColor=t;for(var o=e[n].childNodes,i=0;i<o.length;++i)o[i].style&&(o[i].style.backgroundColor=t)}for(var a=document.getElementsByClassName("rwwarningbox"),n=0;n<a.length;++n)a[n].style&&(a[n].style.backgroundColor=t)},1e3),realnames=document.getElementById("userrealnames");if(realnames){for(var userids=[],usernames=[],list=realnames.innerHTML.split('title="User:'),i=1;i<list.length;++i){var id=list[i].split('"')[0].split(" (page")[0],name=list[i].split("<")[0].split(">")[1];userids.push(id),usernames.push(name)}elem=document.getElementsByClassName("userid");for(var i=0;i<elem.length;i++){var id=elem[i].innerHTML,n=userids.indexOf(id);0<=n&&(elem[i].innerHTML=usernames[n],elem[i].style.display="block")}}var autorefresh=document.getElementById("autorefresh"),id,fr;null!=autorefresh&&(id=autorefresh.innerHTML,fr=document.createElement("IFRAME"),fr.src="http://ropewiki.com/api.php?action=sfautoedit&form=AutoRefresh&target=Votes:AutoRefresh&query=AutoRefresh[Location]="+id,fr.style.display="none",document.body.appendChild(fr));var kmlicons=document.getElementById("kmlicons");null!=kmlicons&&(kmliconlist=kmlicons.innerHTML.split(","));for(var lines=document.getElementsByClassName("pinmap"),i=0,icon,idlist;i<lines.length;i++){lines[i].id&&(idlist=lines[i].id.split("."),1<idlist.length&&(icon=kmliconlist[6*Number(idlist[1])+Number(idlist[0])]));var link=lines[i].parentNode.getElementsByTagName("A")[0];lines[i].id=id=link.innerHTML,lines[i].innerHTML=pinicon(lines[i].id,icon)+lines[i].innerHTML}for(var domains=document.getElementsByClassName("favicon"),i=0;i<domains.length;i++){var links=domains[i].getElementsByTagName("A"),link=links[0],href=link.href,fvcurl=getDomainFaviconURL(href),img='<img width="32px" height="32px" style="vertical-align:middle;margin-left:0px;margin-top:0px;width:32px;height:32px" src="'+fvcurl+'"/>';link.innerHTML=img+'<span style="vertical-align: middle;"> '+link.innerHTML+"</span>"}var fav=document.getElementById("favlinks");fav&&(fav.innerHTML='<a href="javascript:openfavlinks();">'+fav.innerHTML+"</a>");var fav=document.getElementById("allfavlinks");fav&&openfavlinks();var coords="",kmlmarker=document.getElementById("kmlmarker");kmlmarker&&(coords=kmlmarker.innerHTML.toString().split(" ").join(""));var staticdebug="undefined"!=typeof staticscripts,weatherdiv=document.getElementById("weatherdiv"),url;0<coords.length&&weatherdiv&&weather&&(url=staticdebug?"http://localhost/rw/umpqua.json":"http://api.wunderground.com/api/bc1f237fb64ef165/alerts/forecast10day/geolookup/q/"+coords+".json",$.getJSON(geturl(url),function(e){if(e&&e.forecast&&e.forecast.simpleforecast&&e.forecast.simpleforecast.forecastday&&0<e.forecast.simpleforecast.forecastday.length){var t,n=weatherdiv.getElementsByTagName("A");n&&0<n.length&&n[0].href&&(t=n[0].href);var o,i,a=e.forecast.simpleforecast.forecastday,l="";l+='<div class="wstlogo noprint">',t&&(l+='<a href="'+t+'">'),l+='<span class="notranslate">',e.location&&e.location.nearby_weather_stations&&e.location.nearby_weather_stations.pws&&e.location.nearby_weather_stations.pws.station&&0<e.location.nearby_weather_stations.pws.station.length&&((o=e.location.nearby_weather_stations.pws.station[0]).name="((&#9899;)) "+o.id),e.location&&e.location.nearby_weather_stations&&e.location.nearby_weather_stations.airport&&e.location.nearby_weather_stations.airport.station&&0<e.location.nearby_weather_stations.airport.station.length&&((i=e.location.nearby_weather_stations.airport.station[0]).name="&#9992;"+i.city);var r,s,c,m,d,p,g=coords.split(",");2<=g.length&&(s=r=1e15,o&&(r=Distance({lat:g[0],lng:g[1]},{lat:o.lat,lng:o.lon})),i&&(s=Distance({lat:g[0],lng:g[1]},{lat:i.lat,lng:i.lon}))<r&&(o=i,r=s),l+="~"+mi(r)+" ",map&&o&&(c=[],o.neighborhood&&c.push(o.neighborhood),o.city&&c.push(o.city),o.state?c.push(o.state):o.country&&c.push(o.country),m=new google.maps.LatLng(o.lat,o.lon),d=new google.maps.InfoWindow({content:"<b>"+o.name+'</b><div class="textselect">'+c.join(", ")+'</div><div class="textselect">'+displaylocation(o.lat,o.lon)+'<div id="elevation"></div></div>'}),p=new google.maps.Marker({position:m,map:map,infowindow:d,optimized:!1,zIndex:10,icon:{url:"https://icons.wxug.com/logos/PNG/wundergroundLogo_4c.png",scaledSize:new google.maps.Size(45,32)}}),google.maps.event.addListener(p,"click",function(){this.infowindow.open(map,this),getgeoelevation(this.getPosition(),"elevation","Elevation: ")}))),o&&(l+=" "+o.name);var u=a.length-1;l+=": "+a[0].date.day+" "+a[0].date.monthname_short+" - "+a[u].date.day+" "+a[u].date.monthname_short+" ",l+="</span>",l+='<div style="position:relative"><img style="position:absolute;left:-75px;width:75px" src="https://icons.wxug.com/logos/PNG/wundergroundLogo_4c.png"/></div>',t&&(l+="</a>"),l+="</div>",l+='<table class="wikitable wst bst notranslate"><tr style="line-height:5px">';for(var h=0;h<a.length;++h)l+="<th>"+a[h].date.weekday_short+"<br>",l+="</th>";l+="</tr><tr>";for(h=0;h<a.length;++h){var f=metric?a[h].high.celsius:a[h].high.fahrenheit,v=metric?a[h].low.celsius:a[h].low.fahrenheit;l+='<td title="'+a[h].date.day+" "+a[h].date.monthname+" : "+a[h].conditions+", Max "+f+" Min "+v+'">',l+='<div><img class="weatherimg" src="'+a[h].icon_url+'"/></div>',l+='<div class="weatherh">'+f+'</div><div class="weatherl">'+v+"</div>",l+="</td>"}if(l+="</tr>",e.alerts&&0<e.alerts.length){l+='<tr><td colspan="'+a.length+'" style="padding:0;">';for(var y=[],h=0;h<e.alerts.length;++h)y.push(e.alerts[h].description+"!");t&&(l+='<a href="'+t+'">'),l+='<div class="weatheralt rwwarningbox">'+y.join("<br>")+"</div>",t&&(l+="</a>"),l+="</td></tr>"}l+="</table>",weatherdiv.innerHTML="<div>"+l+"</div>"}}));var maptype=document.getElementById("kmltype"),waterflowdiv=document.getElementById("waterflowdiv"),url;function extractVal(e,t){var n=e.indexOf(t);if(n<0)return"";if((n=e.indexOf(":",n))<0)return"";var o=e.indexOf(" ",n);return e.substring(n+1,o)}0<coords.length&&waterflowdiv&&maptype&&("topo"==maptype.innerHTML||staticdebug)&&(url=staticdebug?"http://d5a.net/rwr?waterflow=winfo=33.7717,-111.1197":"http://d5a.net/rwr?waterflow=winfo="+coords,$.getJSON(geturl(url),function(e){var t,n,o="";e&&e.list&&0<e.list.length&&(t=e.list[0],n=parseInt(extractVal(t,"Drain")),isNaN(n)||(o='<span class="notranslate">~'+(o=metric?Math.round(n)+"km<sup>2</sup>":Math.round(.386*n)+"mi<sup>2</sup>")+"</span>",100<n?o+='<hr id="cd5" title="May massively flood with heavy rains and keep flooded for many days afterwards">':50<n?o+='<hr id="cd4" title="May massively flood with heavy rains">':25<n&&(o+='<hr id="cd3" title="May flood with heavy rains">'))),waterflowdiv.className="",waterflowdiv.innerHTML+=" "+o}));var tt,it,isrc=null,ttmove=0,ttshow=0,boxes=document.getElementsByClassName("galleryboxview");document.onmousemove=function(){tt&&it&&0<ttmove&&(tt.style.display="none",it.src=""),++ttmove,ttshow=-3};for(var i=0;i<boxes.length;i++)boxes[i].onmouseout=function(){isrc=null},boxes[i].onmouseover=function(){var e=$(this).find("#highres");e&&0!=e.length&&(isrc=e[0].innerHTML,tt||((tt=document.createElement("div")).style.cssText="background-color:none; position: fixed; top:5%; left:5%; zIndex:9999; width:90%; height: 90%; text-align:center; display:none",(it=document.createElement("img")).style.cssText="width:auto; height:100%;border: 1px solid #404040;margin:10px;background-color:#f0f0f0",it.src=isrc,it.alt="LOADING...",tt.appendChild(it),document.body.appendChild(tt)))}}function deftext(e){return null==e||""==e||"&"==e[0]||" "==e[0]||160==e.charCodeAt(0)}function urldecode(e){return decodeURIComponent(e).split("+").join(" ")}function urlencode(e){return encodeURIComponent(e)}function urlget(e,t,n){var o,i=n,a=e.indexOf(t);return 0<=a&&(a+=t.length,i=urldecode(i=0<(o=e.indexOf("&",a))?e.substring(a,o):e.substring(a))),i}function addparam(e,t,n){var o,i,a="&"+t+"=",l=e.indexOf(a);return l<0?e+=a+n:(o=e.substr(0,l),i=e.substr(l+a.length),e=o+a+n,i!=n&&(0<i.length&&"&"!=i[0]&&(e+=","),e+=i)),e}function getparam(e,t,n){return urlget(e,"&"+t+"=",n)}function setparam(e,t,n){var o,i,a,l="&"+t+"=",r=e.indexOf(l);return 0<=r&&(o="",i=e.substr(0,r),0<=(a=e.indexOf("&",r+1))&&(o=e.substr(a)),e=i+o),e+=l+n}var sortby="";function loadFormInterface(){function e(e,t,n){var o,i;(l=document.getElementById(e))&&(i="black",deftext(o=getparam(a,e,l.innerHTML))&&(i="silver"),l.innerHTML=t+"color:"+i+';" onfocus="inputfocus(this)" onkeydown="inputkey(event,'+n+')" value="'+o+'">')}var t,a=window.location.href.toString(),n=document.getElementById("locfind");n&&(e("locname",'<input id="locnameval" class="submitoff" autocomplete="on" style="width:90%;',"locsearch"),e("locdist",'<input id="locdistval" class="submitoff" autocomplete="on" size="15" style="',"locsearch"),n.innerHTML='<input class="submitoff" type="submit" onclick="locsearch()" value="'+n.innerHTML+'">',(t=document.getElementById("mapfind"))&&(t.innerHTML='<input class="submitoff" type="submit" onclick="mapsearch()" value="'+t.innerHTML+'">'));var o,l,i=document.getElementById("regfind");i&&(e("regname",'<input id="regnameval" class="submitoff" autocomplete="on" style="width:30em;',"regsearch"),i.innerHTML='<input class="submitoff" type="submit" onclick="regsearch()" value="'+i.innerHTML+'">',""!=(o=urldecode(getCookie("regnameval")))&&((l=document.getElementById("regnameval")).value=o,1<a.split("?").length&&l.focus()));var r=document.getElementById("filters");if(r)for(var s=document.getElementsByClassName("optionchk"),c=0;c<s.length;c++){var m=s[c].id+"chk",d=0<a.indexOf("&"+m);s[c].innerHTML='<label style="white-space: nowrap;"><input id="'+m+'" class="optionschk submitoff" type="checkbox" onclick="toggle'+m+"('"+m+"')\" "+(d?"checked":"")+">"+s[c].innerHTML+"</label>",toggleOption(m,d)}if(r){var s=document.getElementsByClassName("rwSort"),p=document.getElementById("sortby");p&&(sortby=p.innerHTML);for(c=0;c<s.length;c++){var g="rwsortud.gif";s[c].id==sortby&&(g="rwsortdn.gif"),"-"+s[c].id==sortby&&(g="rwsortup.gif"),s[c].className+=" notranslate",s[c].style.cssText+="cursor: pointer; background-repeat: no-repeat; background-position: center right; padding-right:9px; padding-left:0px; background-image: url(http://sites.google.com/site/rwicons/"+g+");",s[c].onclick=function(e){var t=$(this).offset(),n=$(this).height(),o=t.top+n/2;nsortby=e.pageY<o?(psortby="-"+this.id,this.id):(psortby=this.id,"-"+this.id),sortby=sortby==psortby?nsortby:psortby,filtersearch()}}}for(s=document.getElementsByClassName("filtersel"),c=0;c<s.length;c++){for(var u=s[c].id+"flt",h=s[c].innerHTML.split(","),f="",v=urlget(a,s[c].id+"=","").split(","),y=getCookie(u).split(","),w=0;w<h.length;++w){d=0<=y.indexOf(h[w]);if(0<v.length&&""!=v[0]&&(d=0<=v.indexOf(h[w])),f+="<option "+(d?'selected="selected"':"")+'value="'+h[w]+'">'+h[w]+"</option>",d)for(var k=document.getElementsByClassName(u+h[w]),b=0;b<k.length;b++)k[b].style.display=""}s[c].innerHTML='<select id="'+u+'" class="'+u+'" onclick="toggleFilterSel(this)">'+f+"</select>"}for(s=document.getElementsByClassName("filterchk"),c=0;c<s.length;c++){for(var u=s[c].id+"flt",h=s[c].innerHTML.split(","),x=document.getElementById(s[c].id+"icons"),f="",v=urlget(a,s[c].id+"=","").split(","),w=0;w<h.length;++w){d=""!=getCookie(m=u+"_"+h[w]);0<v.length&&""!=v[0]&&(d=0<=v.indexOf(h[w])),f+=x?' <label title="'+x.childNodes[w].title+'"><input id="'+m+'" class="'+u+'" style="margin:0;padding=0" type="checkbox" onclick="toggleFilter(\''+m+"')\" "+(d?"checked":"")+">"+x.childNodes[w].innerHTML+"</label>":' <label title="'+h[w]+'"><input id="'+m+'" class="'+u+'" style="" type="checkbox" onclick="toggleFilter(\''+m+"')\" "+(d?"checked":"")+">"+h[w]+"</label>"}s[c].innerHTML=f}var T=document.getElementById("filterbutton");T&&(T.innerHTML='<input class="submitoff" type="submit" onclick="filtersearch()" value="'+T.innerHTML+'">');var L=document.getElementById("starshowhide");if(L&&r){for(var E=L.getElementsByTagName("A"),c=0;c<E.length;++c)E[c].removeAttribute("href");for(var I="border:2px solid #0070B0",M=L.getElementsByTagName("IMG"),c=0;c<M.length;++c)M[c].style.cssText=I,M[c].removeAttribute("href"),M[c].active=!0,M[c].q=0,M[c].alt&&(M[c].q=Number(M[c].alt)),M[c].onclick=function(){this.active=!this.active,this.style.cssText=this.active?I:"";for(var e=qmaps[this.q]=this.active?map:null,t=0;t<markers.length;++t)markers[t].q==this.q&&(markers[t].setMap(e),markers[t].highlight&&markers[t].highlight.setMap(e))}}document.getElementById("locdefault")&&toggleOption(m="locsearchchk",!0);for(s=document.getElementsByClassName("slideshowchk"),c=0;c<s.length;c++)s[c].innerHTML='<label style="white-space: nowrap;"><input class="slideshowschk submitoff" type="checkbox" onclick="toggleSlideshow()" '+(slideshowchk?"checked":"")+">"+s[c].innerHTML+"</label>";toggleSlideshow(slideshowchk);var B=document.getElementsByClassName("optionform"),C=window.location.href;if(1<(C=C.split("#")[0].split("?")).length)for(var S=C[1].replace("&locname=","&noloc=").replace("&locsearchchk=on",""),c=0;c<B.length;c++)for(E=B[c].getElementsByTagName("A"),w=0;w<E.length;++w){var N=E[w].attributes.href;N&&N.value&&(0<=(f=N.value).indexOf("?")?f+="&"+S:f+="?"+S,N.value=f)}CollapsibleLists.apply()}var searchmapn=-1,searchmappt=[],searchmaprectangle;function searchmap(){map.setOptions({draggableCursor:"crosshair"});var e=document.getElementById("searchinfo");e&&(e.innerHTML='<span class="rwwarningbox"><b>CLICK ON MAP TO DEFINE SEARCH AREA</b></span>'),searchmapn=0}function searchmaprun(){map.setOptions({draggableCursor:""}),searchmapn=-1,searchmappt=[];var e=document.getElementById("searchinfo");e&&(e.innerHTML='<span class="rwwarningbox"><b>SEARCHING...</b></span>'),mapsearchbounds(searchmaprectangle.bounds,-1)}function mapsearchbounds(e,t){var n,o,i,a=document.getElementById("locsearchchk");null!=map&&null!=a&&(n=e.getSouthWest(),o=e.getNorthEast(),a.checked=!0,i="Coord:"+Math.round(1e3*n.lat())/1e3+","+Math.round(1e3*n.lng())/1e3+","+Math.round(1e3*o.lat())/1e3+","+Math.round(1e3*o.lng())/1e3,0<=t&&(i+=","+t),document.getElementById("locnameval").value=i),filtersearch()}function mapsearch(){mapsearchbounds(map.getBounds(),map.getZoom())}function fbusersearch(){var e=prompt("Please enter your Facebook name",getCookie("fbuser"));e&&(setCookie("fbuser",e),document.body.style.cursor="wait",window.location.href="http://ropewiki.com/Location?onlycuser="+e.split(" ").join("")+"%40Facebook&sortby=-Has_condition_date")}function regsearch(){var e=document.getElementById("regnameval");if(""==e.value||!deftext(e.value)){var t=(t=window.location.href).split("#")[0].split("?")[0],n=e.value;0<n.length&&(t+="?region="+urlencode(n)),setCookie("regnameval",urlencode(n));for(var o=document.getElementsByClassName("submitoff"),i=0;i<o.length;i++)o[i].disabled=!0;document.body.style.cursor="wait",window.location.href=t}}function filtersearch(e){var t=window.location.href;void 0!==e&&(t=e);var t=t.split("#")[0].split("?")[0],n="",o=document.getElementsByClassName("optionschk");if(null!=o)for(var i=0;i<o.length;i++)o[i].checked&&(n=addparam(n,o[i].id,"on"));var a=document.getElementById("filterschk");if(null!=a&&a.checked){for(var l=document.getElementsByClassName("filtersel"),i=0;i<l.length;i++)if("none"!=l[i].style.display)for(var r=l[i].id+"flt",s=l[i].getElementsByClassName(r),c=0;c<s.length;++c)var m=s[c].selectedIndex,d=s[c].options,n=addparam(n,l[i].id,d[m].text);for(l=document.getElementsByClassName("filterchk"),i=0;i<l.length;i++){for(var r=l[i].id+"flt",s=document.getElementsByClassName(r),p=[],c=0;c<s.length;c++)s[c].checked&&p.push(s[c].id.substring(s[c].id.lastIndexOf("_")+1));n=addparam(n,l[i].id,p.join())}}var g,u,h=document.getElementById("locsearchchk");void 0===e&&null!=h&&h.checked&&(deftext(g=document.getElementById("locnameval").value)||(deftext(u=document.getElementById("locdistval").value)&&"Coord:"!=g.substr(0,6)&&(u="50mi"),t="http://ropewiki.com/Location",n=addparam(n,"locname",urlencode(g)),deftext(u)||(n=addparam(n,"locdist",urlencode(u)))));var f=document.getElementsByClassName("optionsurl");if(null!=f)for(i=0;i<f.length;i++){var v=f[i].innerHTML;0<v.length&&(n=addparam(n,f[i].id,v))}if(sortby&&(n=addparam(n,"sortby",sortby)),""!=n&&(t+="?jform"+n),void 0!==e)return t;for(var y=document.getElementsByClassName("submitoff"),i=0;i<y.length;i++)y[i].disabled=!0;document.body.style.cursor="wait",window.location.href=t}function locsearch(){var e=document.getElementById("locnameval");null!=e&&deftext(e.value)||filtersearch()}function toggleFilterSel(e,t){var n=e.selectedIndex,o=e.options;null==t&&(t=o[n].text),e.value=t;for(var i=0;i<o.length;++i)if(""!=o[i].text)for(var a=o[i].text,l=document.getElementsByClassName(e.id+a),r=0;r<l.length;r++)l[r].style.display=a==t?"":"none";return setCookie(e.id,t),t}function toggleFilter(e,t){return null==t&&(t=document.getElementById(e).checked),setCookie(e,(document.getElementById(e).checked=t)?"on":""),t}function toggleOption(e,t){checked=toggleFilter(e,t),elems=document.getElementsByClassName(e.split("chk").join("on"));for(var n=0;n<elems.length;n++)elems[n].style.display=checked?"":"none";elems=document.getElementsByClassName(e.split("chk").join("off"));for(n=0;n<elems.length;n++)elems[n].style.display=checked?"none":"";return checked}function togglelocsearchchk(e){toggleOption(e)}function togglefilterschk(e){toggleOption(e)||filtersearch()}function toggledisplayschk(e){if(!toggleOption(e)){elems=document.getElementsByClassName(e.split("chk").join("on"));for(var t=0;t<elems.length;t++)toggleFilter(elems[t].id+"chk",!1);filtersearch()}}function togglenomapchk(e){filtersearch()}function togglefulltablechk(e){filtersearch()}function addhighlight(e){for(var t=0;t<markers.length;++t)if(0<=e.indexOf(markers[t].name)){var n=markers[t];if(n.highlight)continue;var o=new google.maps.Marker({position:n.getPosition(),icon:"http://ropewiki.com/images/e/e6/Starn_y.png",draggable:!1,clickable:!1,optimized:!1,zIndex:n.zIndex-1});o.setMap(qmaps[n.q]),n.highlight=o,n.infowindow&&n.infowindow.content&&(n.infowindow.content=n.infowindow.content.replace('value="+"','value="*"'))}for(var i=document.getElementsByClassName("pinicon"),t=0;t<i.length;++t)0<=e.indexOf(i[t].id)&&(i[t].style.backgroundImage="url(http://ropewiki.com/images/e/e6/Starn_y.png)")}var oldid="@",map,gxml;function addbutton(a){var e,t=document.getElementById("kmladdbutton");t&&(function e(t){for(var n=t.childNodes,o=0;o<n.length;++o){if((t=n[o]).attributes)for(var i=0;i<t.attributes.length;++i)0<=t.attributes[i].value.indexOf(oldid)&&(t.attributes[i].value=t.attributes[i].value.split(oldid).join(a));e(t)}}(t),0<(e=t.getElementsByTagName("BUTTON")).length&&e[0].click(),lastinfowindow&&lastinfowindow.close(),addhighlight([a]),oldid=a)}function inputkey(e,t){13==e.which&&t()}function inputfocus(e){e.style.color="black",deftext(e.value)&&(e.value="")}function getTextFromHyperlink(e){var t=e.search("href=");return e.slice(t).split('"')[1]}var zindex=0,markers=[],handlekeys=!1,lastinfowindow=null;function displayinfowindow(e){tooltip.hide(),lastinfowindow&&lastinfowindow.close(),e.infowindow.setZIndex(++zindex),e.infowindow.open(map,e),getgeoelevation(e.getPosition(),"infoelevation","~"),lastinfowindow=e.infowindow}function pinicon(e,t){return t&&void 0!==t||(t="http://ropewiki.com/images/8/86/PinMap.png"),'<img src="'+t+'" id="'+e+'" class="pinicon" title="Show location on map" style="cursor:pointer;vertical-align:middle" onclick=\'pinmap(this.id)\'/>'}function pinmap(e){for(var t=0;t<markers.length;++t)if(markers[t].name==e){var n=$("#mapbox").offset().top;return n<$(window).scrollTop()&&window.scrollTo(0,n),$("#mapcover").css({display:"none"}),map.panTo(markers[t].position),void window.setTimeout(function(){displayinfowindow(markers[t])},500)}}var kmliconlist=["http://ropewiki.com/images/7/75/Starn00.png","http://ropewiki.com/images/8/87/Starn10.png","http://ropewiki.com/images/1/15/Starn20.png","http://ropewiki.com/images/d/d3/Starn30.png","http://ropewiki.com/images/a/a0/Starn40.png","http://ropewiki.com/images/c/cc/Starn50.png","http://ropewiki.com/images/b/b6/Starn01.png","http://ropewiki.com/images/1/12/Starn11.png","http://ropewiki.com/images/b/b7/Starn21.png","http://ropewiki.com/images/2/2e/Starn31.png","http://ropewiki.com/images/1/1d/Starn41.png","http://ropewiki.com/images/f/fe/Starn51.png","http://ropewiki.com/images/3/3a/Starn02.png","http://ropewiki.com/images/a/a4/Starn12.png","http://ropewiki.com/images/1/13/Starn22.png","http://ropewiki.com/images/3/32/Starn32.png","http://ropewiki.com/images/7/77/Starn42.png","http://ropewiki.com/images/1/11/Starn52.png","http://ropewiki.com/images/b/bd/Starn03.png","http://ropewiki.com/images/0/09/Starn13.png","http://ropewiki.com/images/9/98/Starn23.png","http://ropewiki.com/images/0/07/Starn33.png","http://ropewiki.com/images/f/fb/Starn43.png","http://ropewiki.com/images/d/dc/Starn53.png","http://ropewiki.com/images/2/25/Starn04.png","http://ropewiki.com/images/7/73/Starn14.png","http://ropewiki.com/images/e/ea/Starn24.png","http://ropewiki.com/images/6/6a/Starn34.png","http://ropewiki.com/images/3/31/Starn44.png","http://ropewiki.com/images/2/27/Starn54.png","http://ropewiki.com/images/2/29/Starn05.png","http://ropewiki.com/images/d/d9/Starn15.png","http://ropewiki.com/images/e/e0/Starn25.png","http://ropewiki.com/images/0/09/Starn35.png","http://ropewiki.com/images/8/81/Starn45.png","http://ropewiki.com/images/3/37/Starn55.png"],nlist=1e4,qmaps=[];function loadlist(e,t){if(0==qmaps.length)for(var n=0;n<6;++n)qmaps.push(map);var o=document.getElementById("kmlstars");null!=o&&o.innerHTML.split(",");var i=document.getElementById("kmladdbutton");if(document.getElementById("kmlnearby"))for(n=0;n<e.length;++n){var a=e[n],l=[];for(ic=0;ic<e.length;++ic)l.push({id:e[ic].id.split(" ")[0],distance:Distance(a.location,e[ic].location)});l.sort(function(e,t){return e.distance-t.distance});var r=[];for(ic=1;ic<l.length&&ic<=5&&l[ic].distance<20;++ic)r.push(l[ic].id);if(id=a.id.substr(1).split(" ")[0],id&&""!=id){elems=document.getElementsByClassName("nearby");for(var s=0;s<elems.length&&elems[s].id!=id;++s);s<elems.length&&(elems[s].innerHTML="~"+r.join())}}var c=e.length;for(n=0;n<e.length;++n){var m=e[n];if(m.id&&""!=m.id){++c;var d=5e3+--nlist;m.q&&(d+=1e3*m.q);var p="";m.icon&&(p=m.icon);var g="",u="";if(m.description){if(str=m.description,metric){for(var h=str.split(" "),f=0;f<h.length;++f){var v,y="",w=h[f],k=w.indexOf(":");0<=n&&(y=w.substr(0,k+1),w=w.substr(k+1)),"0"<=w[0]&&w[0]<="9"&&("mi"==(v=w.slice(-2))?h[f]=y+uconv(w,mi):"ft"==v&&(h[f]=y+uconv(w,ft)))}str=h.join(" ")}str=acaconv(str),g=u=str}u='<div class="notranslate">'+u.split("*").join("&#9733;")+"</div>";var b,x,T,L,E;m.thumbnail&&(x=b="",0<(T=m.thumbnail.split("/")).length&&(L=T[T.length-1],0<(E=parseInt(L))&&(x='width="'+E+'px"',b='style="border:1px solid #808080"')),u+="<div><img "+b+" "+x+' height="150px" src="'+m.thumbnail+'"/></div>'),m.kmlfile&&""!=m.kmlfile&&(u+="<div><i>",u+="<a href=\"javascript:toggleRoutes('"+urlencode(m.kmlfile)+"','"+urlencode(m.id)+"');\">Show KML Map of the route</a>",u+="</i></div>");var I='<br><span id="infoelevation"></span> - ';I+='<a href="http://ropewiki.com/Weather?pagename='+m.id+'" target="_blank">Weather</a>',I+=' - <a href="http://ropewiki.com/Location?locdist=30mi&locname=Coord:'+m.location.lat+","+m.location.lng+'">Search nearby</a>',u+=displaydirections(m.location.lat,m.location.lng,I);var M='<div style="width:auto;height:auto;overflow:hidden;"><b class="notranslate">'+sitelink(m.id,nonamespace(m.id))+"</b>";i&&(M+='<input class="submitoff addbutton" type="submit" onclick="addbutton(\''+m.id.split("'").join("%27")+'\')" value="+">'),M+="<hr/>"+u+"</div>",m.infocontent&&(M=m.infocontent);var B=new google.maps.InfoWindow({content:M}),C='<b class="nostranslate">'+nonamespace(m.id)+"</b><br>"+g.split("*").join("&#9733;");m.infodescription&&(C=m.infodescription);var S=-1,N=map;null!=m.q&&(N=qmaps[S=m.q]);var H=new google.maps.LatLng(m.location.lat,m.location.lng),O=new google.maps.Marker({position:H,map:N,icon:p,name:nonamespace(m.id),description:C,infowindow:B,zIndex:d,optimized:!1});O.q=S,O.oposition=H,google.maps.event.addListener(O,"mouseover",function(e){this.highlight=new google.maps.Marker({position:this.getPosition(),icon:"http://ropewiki.com/images/3/39/Starn_b.png",draggable:!1,clickable:!1,optimized:!1,zIndex:this.zIndex-1}),this.priority=0,this.highlight.setMap(map),tooltip.show(this.description,e,this)}),google.maps.event.addListener(O,"mouseout",function(){tooltip.hide(this),null!=this.highlight&&(this.highlight.setMap(null),this.highlight=null)}),markers.push(O),google.maps.event.addListener(O,"click",function(){displayinfowindow(this)}),boundslist.extend(H)}}var j,R,F,_=document.getElementById("kmladdlist");return!_||0<(j=_.innerHTML.split(";")).length&&addhighlight(j),0<c&&t&&(R=boundslist.getNorthEast(),F=boundslist.getSouthWest(),Distance({lat:R.lat(),lng:R.lng()},{lat:F.lat(),lng:F.lng()})<1?(map.setZoom(11),map.panTo(markers[0].position)):(map.fitBounds(boundslist),map.panToBounds(boundslist)),zindex=6e3),c}var kmllistn=0,kmllisturl,tablelisturl,kmlsummary;function getrwlist(e){var a=[];return $.each(e.query.results,function(e,t){++kmllistn;var n,o,i={id:t.fulltext};(o=t.printouts["Has coordinates"])&&0<o.length&&(i.location={lat:o[0].lat,lng:o[0].lon},(o=t.printouts["Has star rating"])&&0<o.length&&(i.q=Number(o[0]),(o=t.printouts["Has location class"])&&0<o.length&&(i.icon=kmliconlist[i.q+6*Number(o[0])])),kmlsummary&&"#"==i.id[0]&&(n=i.id.slice(1).split(" ")[0],i.icon="http://sites.google.com/site/rwicons/bg"+i.q+"_"+n+".png"),(o=t.printouts["Has summary"])&&0<o.length&&(i.description=o[0]),(o=t.printouts["Has banner image file"])&&0<o.length&&(i.thumbnail=o[0]),(o=t.printouts["Has KML file"])&&0<o.length&&(i.kmlfile=o[0]),(o=t.printouts["Located in region"])&&0<o.length&&(i.region=o[0].fulltext),a.push(i))}),a}function getkmllist(e){var t=getrwlist(e);void 0===e["query-continue-offset"]&&morestop(),loadlist(t,!0)}function findtag(e,t,n){for(var o=function e(t,n){for(var o=[],i=0;i<t.length;++i){var a=t[i];a.nodeName==n?o.push(a):o=o.concat(e(a.childNodes,n))}return o}(e,t),i=0;i<o.length;++i)n(o[i])}function morestop(){var e=document.getElementById("loccount");e&&e.parentNode.removeChild(e);var t=document.getElementById("loadmore");t&&t.parentNode.removeChild(t);var n=$(".loctable .smw-template-furtherresults a");1==n.length&&n[0].parentNode.removeChild(n[0])}var morestep=100,moremapc=0,morelistc=0,boundslist;function morekmllist(e,t){var o,n,i,a;loadingquery=!0,console.log("loadingquery true"),++moremapc,map.setOptions({draggableCursor:"wait"}),$.getJSON(geturl(kmllisturl+"|offset="+e),getkmllist).always(function(){setTimeout(function(){loadingquery=!1,console.log("loadingquery false")},5e3),--moremapc<=0&&map.setOptions({draggableCursor:""})}),0<e&&(1==(o=$(".loctable .loctabledata")).length&&(++morelistc,document.body.style.cursor="wait",$.get(geturl(tablelisturl+"&offset="+e),function(e){var t,n=$("#morekmllist").html($(e).find(".loctable").html());1==n.length&&((t=n[0]).getElementsByName=function(e){return[]},t.getElementById=function(e){return null},loadUserInterface(t),findtag(t.childNodes,"TR",function(e){o[0].appendChild(e)}))}).always(function(){--morelistc<=0&&(document.body.style.cursor="")}))),t<=(e+=morestep)?morestop():((n=document.getElementById("loadmore"))&&(n.innerHTML='<button onclick="morekmllist('+e+","+t+')">+</button> '),(i=document.getElementById("loccount"))&&(i.innerHTML=e+" of "),1==(a=$(".loctable .smw-template-furtherresults a")).length&&(a[0].href="javascript:morekmllist("+e+","+t+");"))}function setmarker(e,t,n){var o=new google.maps.LatLng(e,t),i=new google.maps.InfoWindow({content:'<div class="textselect">'+displaylocation(e,t)+'<div id="elevation"></div><div id="geocode" style="max-width:200px"></div>'+displaydirections(e,t)+"</div>"}),a=new google.maps.Marker({position:o,map:map,infowindow:i,optimized:!1,zIndex:n});google.maps.event.addListener(a,"click",function(){this.infowindow.open(map,this),getgeoelevation(this.getPosition(),"elevation","Elevation: "),getgeocode(e,t,"geocode")}),boundslist.extend(o)}function CLIP(e,t){return e%(1<<t)}function TYZ(e,t){return(1<<t)-e-1}function Box(e,t,n,o){function r(e,t,n){return Math.min(Math.max(e,t),n)}function i(e,t,n,o){var i=e*(1<<t),a=r(e*n,0,i-1)/i-.5,l=.5-r(e*o,0,i-1)/i;return{lat:90-360*Math.atan(Math.exp(2*-l*Math.PI))/Math.PI,lng:360*a}}var a=i(o,n,e,t),l=i(o,n,e+1,t+1);return{lat1:a.lat,lat2:l.lat,lng1:a.lng,lng2:l.lng}}function WmsBox(e,t,n){function o(e,t,n){var o,i={x:t,y:n};return e&&(i.x=20037508.34*n/180,o=Math.log(Math.tan((90+t)*Math.PI/360))/(Math.PI/180),i.y=20037508.34*o/180),i}var i=o(t,e.lat1,e.lng1),a=o(t,e.lat2,e.lng2),l=[i.x<a.x?i.x:a.x,i.y<a.y?i.y:a.y,i.x<a.x?a.x:i.x,i.y<a.y?a.y:i.y];return n?l[1]+","+l[0]+","+l[3]+","+l[2]:l[0]+","+l[1]+","+l[2]+","+l[3]}var loadingmap=!0,loadingtiles=!1,loadingtiles2=!1,loadingkml=!1,loadingquery=!1,loadingquery2=!1;function isloadingmap(){return loadingmap||loadingtiles||loadingtiles2||loadingkml||loadingquery||loadingquery2}function initializemap(){var o,i,a,l,r,s,c,n,m;if(tooltip=(c="tooltip",n=0,m=!!document.all,{show:function(e,t,n){if(e&&""!=e){if(n&&o&&n.highlight&&o.highlight&&n.priority>o.priority)return n.highlight.setMap(null),void(n.highlight=null);o&&n!=o&&o.highlight&&(o.highlight.setMap(null),o.highlight=null),o=n,null==i&&((i=document.createElement("div")).style.backgroundColor="white",i.style.padding="3px",i.style.position="absolute",i.style.zIndex=6e4,i.style.fontFamily="Arial,sans-serif",i.style.fontSize="10px",i.setAttribute("id",c),i.className="notranslate",(a=document.createElement("div")).setAttribute("id",c+"top"),(l=document.createElement("div")).setAttribute("id",c+"cont"),(r=document.createElement("div")).setAttribute("id",c+"bot"),i.appendChild(a),i.appendChild(l),i.appendChild(r),document.body.appendChild(i),i.style.opacity=0,i.style.filter="alpha(opacity=0)",document.onmousemove=this.pos),i.style.display="block",l&&(l.innerHTML=e),i.style.width=t?t+"px":"auto",!t&&m&&(a.style.display="none",r.style.display="none",i.style.width=i.offsetWidth,a.style.display="block",r.style.display="block"),300<i.offsetWidth&&(i.style.width="300px"),s=parseInt(i.offsetHeight)+3,clearInterval(i.timer),i.timer=setInterval(function(){tooltip.fade(1)},20)}},pos:function(e){var t=m?event.clientY+document.documentElement.scrollTop:e.pageY,n=m?event.clientX+document.documentElement.scrollLeft:e.pageX;i.style.top=t-s+"px",i.style.left=n+3+"px"},fade:function(e){var t;95!=n&&1==e||0!=n&&-1==e?(95-n<(t=10)&&1==e?t=95-n:n<10&&-1==e&&(t=n),n+=t*e,i.style.opacity=.01*n,i.style.filter="alpha(opacity="+n+")"):(clearInterval(i.timer),-1==e&&(i.style.display="none"))},hide:function(e){e&&e!=o||void 0!==i&&(i.timer&&clearInterval(i.timer),i.timer=setInterval(function(){tooltip.fade(-1)},20))}}),X=document.getElementById("mapbox")){var e={zoom:13,scaleControl:!0,keyboardShortcuts:!1,mapTypeId:google.maps.MapTypeId.TERRAIN,mapTypeControl:!0,mapTypeControlOptions:{mapTypeIds:["topo","wtopo","wtopoesri","ocm",google.maps.MapTypeId.TERRAIN,google.maps.MapTypeId.HYBRID,"wsatesri","mxtopo","estopo","frtopo","chtopo","nztopo"],style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,position:google.maps.ControlPosition.TOP_RIGHT},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_CENTER},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_CENTER}},t=document.createElement("DIV");t.id="mapcover",t.className="gmnoprint",t.style.cssText="position:fixed;left:0;top:0;width:100%;height:100%;background-color:transparent;border-color:yellow;border-style: inset;border-width:2px",$(t).on("click",function(e){toggleFullScreen(!0)});var d=document.createElement("DIV");d.style.cssText="font-size:x-small;";var p=[];(map=new google.maps.Map(X,e)).controls[google.maps.ControlPosition.BOTTOM_RIGHT].push(d),p[google.maps.MapTypeId.TERRAIN]=" ",p[google.maps.MapTypeId.HYBRID]=" ";var g=new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://s3-us-west-1.amazonaws.com/ctrelief/relief/"+t+"/"+CLIP(e.x,t)+"/"+CLIP(e.y,t)+".png"},maxZoom:16,name:"Topo",opacity:.25,tileSize:new google.maps.Size(256,256)});map.mapTypes.set("topo",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://s3-us-west-1.amazonaws.com/caltopo/topo/"+t+"/"+CLIP(e.x,t)+"/"+CLIP(e.y,t)+".png"},maxZoom:16,name:"TopoUSA",opacity:1,tileSize:new google.maps.Size(256,256)})),p.topo="<a href='http://caltopo.com' target='_blank'>Topo map by CalTopo</a>",map.mapTypes.set("ocm",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://tile.opencyclemap.org/cycle/"+t+"/"+CLIP(e.x,t)+"/"+CLIP(e.y,t)+".png"},maxZoom:18,name:"OpenCycle",opacity:1,tileSize:new google.maps.Size(256,256)})),p.ocm="<a href='http://thunderforest.com' target='_blank'>Topo map by Thunderforest</a>",map.mapTypes.set("wtopo",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://tile.thunderforest.com/outdoors/"+t+"/"+CLIP(e.x,t)+"/"+CLIP(e.y,t)+".png?apikey=bdbb04f2d5df40cbb86e9e6e1acff6f7"},maxZoom:18,name:"TopoWorld",opacity:1,tileSize:new google.maps.Size(256,256)})),p.wtopo="<a href='http://thunderforest.com' target='_blank'>Topo map by Thunderforest</a>",map.mapTypes.set("wtopoesri",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/"+t+"/"+CLIP(e.y,t)+"/"+CLIP(e.x,t)+".png"},maxZoom:18,name:"TopoESRI",opacity:1,tileSize:new google.maps.Size(256,256)})),p.wtopoesri="<a href='http://arcgisonline.com' target='_blank'>Topo map by ESRI</a>",map.mapTypes.set("wsatesri",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/"+t+"/"+CLIP(e.y,t)+"/"+CLIP(e.x,t)+".png"},maxZoom:18,name:"SatESRI",opacity:1,tileSize:new google.maps.Size(256,256)})),p.wsatesri="<a href='http://arcgisonline.com' target='_blank'>Sat map by ESRI</a>",map.mapTypes.set("estopo",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://www.ign.es/wmts/mapa-raster?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=MTN&STYLE=default&TILEMATRIXSET=GoogleMapsCompatible&TILEMATRIX="+t+"&TILEROW="+CLIP(e.y,t)+"&TILECOL="+CLIP(e.x,t)+"&FORMAT=image%2Fjpeg"},maxZoom:17,name:"TopoSpain",opacity:1,tileSize:new google.maps.Size(256,256)})),p.estopo="<a href='http://sigpac.mapa.es/fega/visor/' target='_blank'>Topo map by IGN</a>",map.mapTypes.set("frtopo",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://RopeWiki:b%40VM709c6Jix@wxs.ign.fr/8m34uuspdybhi9t89lpoeyfl/geoportail/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=GEOGRAPHICALGRIDSYSTEMS.MAPS&STYLE=normal&FORMAT=image/jpeg&TILEMATRIXSET=PM&TILEMATRIX="+t+"&TILEROW="+CLIP(e.y,t)+"&TILECOL="+CLIP(e.x,t)},maxZoom:16,name:"TopoFrance",opacity:1,tileSize:new google.maps.Size(256,256)})),p.frtopo="<a href='http://www.geoportail.gouv.fr' target='_blank'>Topo map by Geoportail</a>",map.mapTypes.set("mxtopo",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://gaiamapas1.inegi.org.mx/mdmCache/service/wms?LAYERS=MapaBaseTopograficov61_consombreado&FORMAT=image/jpeg&MINZOOMLEVEL=5&ZOOMOFFSET=5&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&SRS=EPSG:900913&BBOX="+WmsBox(Box(CLIP(e.x,t),CLIP(e.y,t),t,256),!0,!1)+"&WIDTH=256&HEIGHT=256"},maxZoom:16,name:"TopoMexico",opacity:1,tileSize:new google.maps.Size(256,256)})),p.mxtopo="<a href='http://gaia.inegi.org.mx/mdm6/' target='_blank'>Topo map by INEGI</a>",map.mapTypes.set("nztopo",new google.maps.ImageMapType({getTileUrl:function(e,t){return t<13?"http://tiles-2.topomap.co.nz/tiles-topo250/"+t+"-"+CLIP(e.x,t)+"-"+TYZ(CLIP(e.y,t),t)+".png":"http://tiles-2.topomap.co.nz/tiles-topo50/"+t+"-"+CLIP(e.x,t)+"-"+TYZ(CLIP(e.y,t),t)+".png"},maxZoom:15,name:"TopoNewZealand",opacity:1,tileSize:new google.maps.Size(256,256)})),p.nztopo="<a href='http://www.topomap.co.nz/' target='_blank'>Topo map by Topomap.co.nz</a>",map.mapTypes.set("chtopo",new google.maps.ImageMapType({getTileUrl:function(e,t){return"http://wmts20.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/"+t+"/"+e.x+"/"+e.y+".jpeg"},maxZoom:18,name:"TopoSwiss",opacity:1,tileSize:new google.maps.Size(256,256)})),p.chtopo="<a href='http://map.geo.admin.ch' target='_blank'>Topo map by Swisstopo</a>",google.maps.event.addListener(map,"maptypeid_changed",function(){map.controls[google.maps.ControlPosition.BOTTOM_CENTER].clear(),"topo"==map.getMapTypeId()?map.overlayMapTypes.setAt(0,g):map.overlayMapTypes.clear();var e=p[map.getMapTypeId()];e&&d&&(d.innerHTML=e)}),google.maps.event.addListener(map,"mouseout",function(){mapcover()});var u,h,f=document.getElementById("kmltype");null!=f&&(1<(u=f.innerHTML.split("@")).length&&(map.mapTypes[u[0]].maxZoom=parseInt(u[1])),map.setMapTypeId(u[0])),loadingtiles=!0,console.log("loadingtiles true"),google.maps.event.addListener(map,"tilesloaded",function(e){setTimeout(function(){loadingtiles=!1,console.log("loadingtiles false")},5e3)}),google.maps.event.addListener(map,"bounds_changed",function(e){loadingtiles2=!0,console.log("loadingtiles2 true")}),google.maps.event.addListener(map,"idle",function(e){setTimeout(function(){loadingtiles2=!1,console.log("loadingtiles2 false")},5e3)}),boundslist=new google.maps.LatLngBounds;var v,y=document.getElementById("kmlmarker");null!=y&&(console.log("kmlmarker"),null!=(b=y.innerHTML.split(","))&&1<b.length&&(h="kmlmarker",setmarker(b[0],b[1],0),map.setZoom(13),v=new google.maps.LatLng(b[0],b[1]),map.panTo(v),document.getElementById("elevationdiv")&&getgeoelevation(v,"elevationdiv"," ~")));var w,k=document.getElementById("kmlrect");null!=k&&null!=(b=k.innerHTML.split(","))&&1<b.length&&(h="kmlrect",w=new google.maps.Rectangle({strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.05,map:map,bounds:new google.maps.LatLngBounds(new google.maps.LatLng(b[0],b[1]),new google.maps.LatLng(b[2],b[3])),draggable:!1,clickable:!1,optimized:!1}),boundslist=w.getBounds(),map.fitBounds(boundslist),map.panToBounds(boundslist),4<b.length&&setTimeout(function(){map.setZoom(parseInt(b[4]))},1e3));var b,x,T,L=document.getElementById("kmlcircle");null!=L&&null!=(b=L.innerHTML.split(","))&&1<b.length&&(h="kmlcircle",x={strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.05,map:map,center:new google.maps.LatLng(b[0],b[1]),radius:Number(b[2]),draggable:!1,clickable:!1,optimized:!1},setmarker(b[0],b[1],9e4),null==k&&(T=new google.maps.Circle(x),boundslist=T.getBounds()),map.fitBounds(boundslist),map.panToBounds(boundslist)),kmlsummary=document.getElementById("kmlsummary");var E=document.getElementById("kmllist");if(null!=E){var I=document.getElementById("kmlicons");null!=I&&(kmliconlist=I.innerHTML.split(",")),h="kmllist";for(var M,B,C,S,N,H=E.innerHTML.split("&amp;").join("").split(";"),O=[],j=0;j<H.length;++j){null!=H[j]&&(H[j].length<=0||null!=(M=H[j].split(","))&&(B=parseFloat(M[1]),C=parseFloat(M[2]),isNaN(B)||isNaN(C)||(S={id:urldecode(M[0]),location:{lat:B,lng:C}},3<M.length&&(S.q=Number(M[3]),6<M.length&&(S.icon=kmliconlist[6*Number(M[6])+S.q])),kmlsummary&&"#"==S.id[0]&&(N=S.id.slice(1).split(" ")[0],S.icon="http://sites.google.com/site/rwicons/bg"+S.q+"_"+N+".png"),4<M.length&&(S.description=urldecode(M[4])),5<M.length&&(S.thumbnail=M[5]),O.push(S))))}loadlist(O,!0)}var R,F,_=document.getElementById("kmllistquery");null!=_&&(h="kmllistquery",kmllisturl="http://ropewiki.com/api.php?action=ask&format=json&query="+(E=_).innerHTML+"|%3FHas_coordinates|%3FHas_star_rating|%3FHas_summary|%3FHas_banner_image_file|%3FHas_location_class|%3FHas_KML_file|limit=100",tablelisturl=(tablelisturl=window.location.href.toString()).split("#")[0],tablelisturl+=(tablelisturl.indexOf("?")<0?"?":"&")+"nomapchk=on",(R=document.getElementById("loctotal"))&&morekmllist(0,R.innerHTML));var z,A,P,D=document.getElementById("kmlfile");null==D||F||null!=(K=D.innerHTML)&&0<K.length&&(h="kmlfile",(F=new google.maps.KmlLayer(K)).setMap(map)),null!=kmlsummary&&google.maps.event.addListener(map,"zoom_changed",function(e){loadingquery2=!0,console.log("loadingquery2 true"),null==e&&(e=100);var t=Math.pow(2,map.getZoom()),n=map.getProjection(),o=map.getBounds();if(n&&o){for(var i,a,l=new google.maps.LatLng(o.getNorthEast().lat(),o.getSouthWest().lng()),r=n.fromLatLngToPoint(l),s=0;s<markers.length;s++){(f=markers[s]).p=(i=f.oposition,a=void 0,a=n.fromLatLngToPoint(i),new google.maps.Point(Math.floor((a.x-r.x)*t),Math.floor((a.y-r.y)*t))),f.p.y+=13}for(var c=!0,m=0;m<e&&c;++m){c=!1;for(var d,p,g,u,s=0;s<markers.length;s++)for(var h=s+1;h<markers.length;h++){s!=h&&(d=markers[s].p.x-markers[h].p.x,u=(p=markers[s].p.y-markers[h].p.y)<0?-p:p,(g=d<0?-d:d)<16&&u<16&&(g<16&&(c=(0<d?(markers[s].p.x+=1,--markers[h].p.x):(--markers[s].p.x,markers[h].p.x+=1),!0)),u<16&&(c=(0<p?(markers[s].p.y+=1,--markers[h].p.y):(--markers[s].p.y,markers[h].p.y+=1),!0))))}}console.log("repetitions:"+m+" overlap:"+c+" os:16 st:1");for(var f,v,y,s=0;s<markers.length;s++){(f=markers[s]).p.y-=13;var w=(v=f.p,y=void 0,(y=new google.maps.Point).x=v.x/t+r.x,y.y=v.y/t+r.y,n.fromPointToLatLng(y)),k={lat:parseFloat(w.lat()),lng:parseFloat(w.lng())};isNaN(k.lat)||isNaN(k.lng)?console.log("error "+f.name+":"+f.p+" -> "+k.lat+","+k.lng):f.setPosition(k)}setTimeout(function(){loadingquery2=!1,console.log("loadingquery2 false")},5e3)}else console.log("null proj")}),null==h&&(z=new google.maps.LatLng(0,0),A=new google.maps.InfoWindow({content:"UNKNOWN LOCATION"}),(P=new google.maps.Marker({position:z,map:map,infowindow:A,optimized:!1})).infowindow.open(map,P),google.maps.event.addListener(P,"click",function(){this.infowindow.open(map,this)}),map.panTo(z),map.setZoom(2),map.setMapTypeId(google.maps.MapTypeId.TERRAIN));var G=document.getElementById("kmltitle");null!=G&&((me=document.createElement("DIV")).style.margin="4px 4px 4px 4px",me.innerHTML='<img src="http://chart.apis.google.com/chart?chst=d_text_outline&chld=000000|32|h|FFFFFF|b|'+urlencode(G.innerHTML)+'"/>',map.controls[google.maps.ControlPosition.TOP_CENTER].push(me));var q,U='<div class="gmnoprint maptopcontrols">',W="</div>",V=U+'<img class="gmnoprint" id="fullscreenchk" onclick="toggleFullScreen()" title="Full Screen" src="http://ropewiki.com/images/b/b9/FullscreenIcon.png">'+W;E?(V+=U+'<label><input class="gmnoprint" id="routeschk" type="checkbox" onclick="toggleRoutes()">Show&nbsp;KML&nbsp;</label>'+W,document.getElementById("locsearch")&&((q=document.createElement("DIV")).innerHTML='<div id="searchmap"><span id="searchinfo"></span><button type="search" value="" onclick="searchmap()">Search Map</button></div>',map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(q),searchmaprectangle=new google.maps.Rectangle({strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.05,bounds:new google.maps.LatLngBounds(new google.maps.LatLng(0,0),new google.maps.LatLng(0,0)),draggable:!1,clickable:!1,optimized:!1}),map.addListener("click",function(e){var t;0<=searchmapn&&(new google.maps.Marker({position:e.latLng,map:map,optimized:!1}),searchmappt.push(e.latLng),++searchmapn,(t=new google.maps.LatLngBounds).extend(searchmappt[0]),t.extend(searchmappt[2<=searchmappt.length?1:0]),searchmaprectangle.setBounds(t),searchmaprectangle.setMap(map),2<=searchmapn&&searchmaprun())}),map.addListener("mousemove",function(e){var t;0<searchmapn&&searchmapn<2&&((t=new google.maps.LatLngBounds).extend(searchmappt[0]),t.extend(e.latLng),searchmaprectangle.setBounds(t),searchmaprectangle.setMap(map))}))):G&&(V+=U+'<label><input class="gmnoprint" id="labelschk" type="checkbox" onclick="toggleLabels()" '+(labels?"checked":"")+">TrkLabels&nbsp;</label>"+W),(me=document.createElement("DIV")).style.cssText="z-index:9999;",me.innerHTML=V,map.controls[google.maps.ControlPosition.TOP_LEFT].push(me),map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(t);var Z=document.getElementById("kmlfilep");if(null!=Z){loadingkml=!0,console.log("loadingkml true");var K=Z.innerHTML,J="";if(null!=K&&0<K.length){h="kmlfilep";var X="#mapbox",Y="mapsidebar",Q=document.getElementById("bskmlfile");if(null!=Q){var ee=document.createElement("DIV"),te='<div class = "dropDownOptionsDiv" id="myddOptsDiv">';K=K.split("&amp;").join("&");var ne=Q.innerHTML.toString().split("&amp;").join("&").split(",");urldecode(K).indexOf(urldecode(ne[0]))<0&&ne.unshift(K);for(var oe=[],j=0;j<ne.length;++j){var ie="";noextraction(se=ne[j])&&(ie="color:red;");var ae=0,le=getdomain(se);oe.push(le);for(var re=0;re<oe.length;++re)oe[re]==le&&++ae;1<ae&&(le+="#"+ae),te+='<div class="dropDownItemDiv" onClick="loadSource(\''+se+"','"+le+'\')" style="'+ie+'">'+le+"</div>"}var se,ce=document.getElementsByTagName("BIG");ce&&0<ce.length&&1<ne.length&&(te+='<div class="dropDownItemDiv" onClick="loadSource(\''+(se=urlencode(ce[0].innerHTML))+"','ALL COMBINED')\" style=\"font-weight:bold\">ALL COMBINED</div>"),te+="</div>",te+="<div class=\"dropDownControl\" onclick=\"(document.getElementById('myddOptsDiv').style.display == 'block') ? document.getElementById('myddOptsDiv').style.display = 'none' : document.getElementById('myddOptsDiv').style.display = 'block';\"><span id=\"myddOptsText\">"+getdomain(ne[0])+'</span><img class="dropDownArrow" src="http://maps.gstatic.com/mapfiles/arrow-down.png"/></div>',lastlinks.push(J=ne[0]),ee.className="dropDownControlDiv",ee.style.zIndex=1e3,ee.innerHTML=te,map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(ee),ne.length<2&&(ee.style.display="none")}var me,de=document.createElement("div");function pe(){gxml=new GeoXml("gxml",map,"",{sidebarid:Y,sortbyname:!0,simplelegend:!0,suppressallfolders:!0,showArrows:!0,showLabels:!0,showRouteLabels:labels&&G,showElevation:labels&&G,directions:!0,dohilite:!0,allfoldersopen:!0,hilite:{color:"#aaffff",opacity:.8,width:10,textcolor:"#000000"}}),google.maps.event.addListener(gxml,"loaded",function(){var n;setTimeout(function(){loadingkml=!1,console.log("loadingkml false")},5e3),null!=document.getElementById("hidelegend")&&!showLegend||(n=setInterval(function(){var e,t;null!=document.getElementById("legend")&&(toggleLegend(!0),e=$("#legendbar").width(),t=$("#legendbar").height(),$("#mapbox").width()*$("#mapbox").height()/4<e*t&&toggleLegend(!1),clearInterval(n))},500))}),gxml.load(K,J)}de.setAttribute("id",Y),de.className="notranslate",document.body.appendChild(de),(me=document.createElement("DIV")).innerHTML='<div id="legendbar"><label><input class="gmnoprint" id="legendchk" type="checkbox" onclick="toggleLegend()"><span id="legendlabel">Legend</span></label><br><div id="legend" class="notranslate"></div></div><div id="loadlinks"></div>',map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(me),me.style.maxHeight="90%",me.style.overflow="auto",me.style.zIndex=999,me.style.marginRight="5px","undefined"==typeof staticscripts?$.getScript("undefined"!=typeof geoxmljs?geoxmljs:geturl("http://ropewiki.com/index.php?title=MediaWiki:Geoxml.js&action=raw&ctype=text/javascript"),pe):setTimeout(pe,100)}}var ge=document.getElementById("kmlfilew");null!=ge&&null!=(K=ge.innerHTML)&&0<K.length&&(h="kmlfilew",X="#mapbox","undefined"==typeof staticscripts?$.getScript("undefined"!=typeof geoxmljs?geoxmljs:geturl("http://ropewiki.com/index.php?title=MediaWiki:Geoxml.js&action=raw&ctype=text/javascript"),ue):setTimeout(ue,100)),setTimeout(function(){loadingmap=!1,console.log("loadingmap false")},5e3),$("#mapbox").mouseover(function(e){handlekeys=!0}),$("#mapbox").mouseout(function(e){handlekeys=!1,mapcover()}),$("#mapbox").mousedown(function(e){e.preventDefault()}),$(document).keydown(function(e){if(handlekeys){switch(e.which){case 37:return map.panBy(-128,0),!1;case 38:return map.panBy(0,-128),!1;case 39:return map.panBy(128,0),!1;case 40:return map.panBy(0,128),!1;case 109:case 189:return map.setZoom(map.getZoom()-1),!1;case 107:case 187:return map.setZoom(map.getZoom()+1),!1;case 27:case 8:return null!=toggleFS&&backFullScreen(),!1}}}),$(window).resize(function(){null!=toggleFS?toggleFullScreen(!0):centermap(),smallstyle(),mapcover()})}function ue(){(gxml=new GeoXml("gxml",map,"",{nozoom:!0,simplelegend:!0,suppressallfolders:!0,showArrows:!1,showLabels:!1,patchIcons:!0,showRouteLabels:!1,directions:!1,dohilite:!1,hilite:{color:"#aaffff",opacity:.8,width:10,textcolor:"#000000"}})).load(K,K)}}var piciconlist=[],picloadingmsg="<img height=12 src='http://ropewiki.com/extensions/SemanticForms/skins/loading.gif'/> Loading... ",piclist,picloading,picloadingerr,picloadingn,showLegend,showRoutes,loadedRoutes;function pictureget(t){var e;0!=t.length&&(e=geturl(t.shift()),console.log("getpic "+e),$.getJSON(e,function(e){for(var t=[],n=e.list,o=0;o<n.length;++o){var i=n[o].split(","),a=document.createElement("LI");a.className="gallerybox";var l='<div class="thumbinner" style="width:154px"><a href="'+i[0]+'" target="_blank"><img src="'+i[4]+'" style="width:150px;height:150px;"></a><div class="thumbcaption"><div>'+pinicon(i[0],piciconlist[i[9]])+" <b>"+i[6]+"</b></div><div>"+i[8]+"</div><div>"+i[1]+"</div></div></div>";a.innerHTML=l,a.sortdate=i[5],a.locid=i[0];var r=piclist.getElementsByTagName("LI"),s=0;for(s=0;s<r.length&&r[s].sortdate>=a.sortdate;++s);s==r.length?piclist.appendChild(a):piclist.insertBefore(a,r[s]);var c={lat:parseFloat(i[2].toString()),lng:parseFloat(i[3].toString())};t.push({id:i[0],location:c,zindex:100-o,icon:piciconlist[i[9]],thumbnail:i[4],description:"",infodescription:i[6]+" "+i[8],infocontent:l})}null!=map&&loadlist(t);for(var m=[],r=piclist.getElementsByTagName("LI"),s=250;s<r.length;++s)m.push(r[s].locid),piclist.removeChild(r[s]);for(o=0;o<markers.length;++o)0<=m.indexOf(markers[o].name)&&markers[o].setMap(null)}).error(function(){++picloadingerr,console.log("picerror "+e)}).always(function(){var e="";0<t.length&&(e+=picloadingmsg+Math.round(100*(picloadingn-t.length)/picloadingn)+"%"),0<picloadingerr&&(e+=' <span style="color:red">'+picloadingerr+" ERRORS!</span>"),picloading.innerHTML=e,pictureget(t)}))}function pictureinit(){piclist=document.getElementById("picture-list");var e,n=document.getElementById("picture-rect");n&&piclist&&((picloading=document.createElement("DIV")).innerHTML=picloadingmsg,piclist.parentNode.insertBefore(picloading,piclist),piciconlist["Instagram.com"]="http://ropewiki.com/images/c/c0/InstaIcon.png",piciconlist["Facebook.com"]="http://ropewiki.com/images/0/03/FacebIcon.png",piciconlist["Flickr.com"]="http://ropewiki.com/images/f/f7/FlickIcon.png",piciconlist["Panoramio.com"]="http://ropewiki.com/images/a/a4/PanorIcon.png",e=(0<=window.location.href.toString().indexOf("debug=local")?"http://localhost/rwr?pictures=":"http://d5a.net/rwr?pictures=")+n.innerHTML,$.getJSON(geturl(e),function(e){var n=e.list;for(picloadingerr=0,picloadingn=n.length,t=0;t<3;++t)setTimeout(function(){pictureget(n)},500*t);pictureget(n)}).error(function(){picloading.innerHTML='<div style="color:red">ERROR!</div>'}))}function waterflowinit(){waterflow()}function loadMapInterface(){var e;if(null==document.getElementById("mapbox"))return loadingmap=!1,$(".locateicon").hide(),void console.log("loadingmap none");"undefined"==typeof staticscripts?((e=document.createElement("script")).type="text/javascript",e.src="https://www.google.com/jsapi",document.body.appendChild(e),(e=document.createElement("script")).type="text/javascript",e.src="http://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyDdkcexZV-p5Nj8RwgLYTcegm5jorJpbyw&callback=initializemap",document.body.appendChild(e)):initializemap(),pictureinit(),document.getElementById("waterflow-table")&&("undefined"==typeof staticscripts?$.getScript("undefined"!=typeof waterflowjs?waterflowjs:geturl("http://ropewiki.com/index.php?title=MediaWiki:Waterflow.js&action=raw&ctype=text/javascript"),waterflowinit):setTimeout(waterflowinit,100))}function loadmapScript(){smallstyle(),loadSkin(),loadEditor(),loadFacebook(),loadMapInterface(),loadUserInterface(document),loadFormInterface(),loadTranslation();setInterval(function(){loadTranslation()},2e3);var e=document.createElement("script");e.type="text/javascript",e.src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit",document.body.appendChild(e)}function googleTranslateElementInit(){var e,t=document.getElementById("firstHeading");t&&((e=document.createElement("div")).className="noprint",e.style.cssText="float:right",e.id="google_translate_flags",e.innerHTML='<table class="noprint"><tr><td><img src="http://ropewiki.com/images/c/c9/FlagIcon.png"/></td><td id="google_translate_element"></td></tr></table>',t.insertBefore(e,t.firstChild),new google.translate.TranslateElement({pageLanguage:"en",multilanguagePage:!0,gaTrack:!0,gaId:"UA-78683801-1"},"google_translate_element"))}function toggleLegend(e){var t=document.getElementById("legend"),n=document.getElementById("legendlabel"),o=document.getElementById("mapsidebar");null==showLegend||e?(t&&o&&(t.style.display="block",t.innerHTML=t.innerHTML+o.innerHTML,o.innerHTML=""),n&&null==showLegend&&(showLegend=n.innerHTML)):(t&&(t.style.display="none"),showLegend=null);var i=document.getElementById("legendchk");i&&(i.checked=null!=showLegend)}function toggleRoutes(n,o){idchk="routeschk";var e=document.getElementById("kmlroutes");if(e){var i=e.innerHTML.split("&amp;").join("&");if(!gxml||n){function t(){gxml=new GeoXml("gxml",map,"",{nozoom:!0,simplelegend:!0,suppressallfolders:!0,showArrows:!1,showLabels:!1,patchIcons:!0,showRouteLabels:!1,directions:!0,dohilite:!0,hilite:{color:"#aaffff",opacity:.8,width:10,textcolor:"#000000"}});var e=n||i,t=o||t;gxml.load(e,t,t)}if("undefined"==typeof staticscripts?$.getScript("undefined"!=typeof geoxmljs?geoxmljs:geturl("http://ropewiki.com/index.php?title=MediaWiki:Geoxml.js&action=raw&ctype=text/javascript"),t):setTimeout(t,100),n)return;loadedRoutes=showRoutes="on"}else null==showRoutes?(showRoutes="on",null==loadedRoutes?(gxml.load(i,"KML","KML"),loadedRoutes="on"):gxml.overlayman.Show()):(showRoutes=null,gxml.overlayman.Hide());document.getElementById(idchk).checked=null!=showRoutes,google.maps.event.trigger(map,"resize")}}window.onload=loadmapScript;var fshash="#fullscreen",toggleFS,clistloading;function backFullScreen(){window.history.back()}function mapcover(){var e=$("#mapbox").width(),t=$(window).width()-e;!toggleFS&&(t<50||e<500)?$("#mapcover").css({display:"block"}):$("#mapcover").css({display:"none"})}function centermap(){var e;map&&(e=map.getCenter(),google.maps.event.trigger(map,"resize"),map.panTo(e))}function toggleFullScreen(e){var t=document.getElementById("mapbox");if(t){if(null==toggleFS||e){if(null==toggleFS){toggleFS={parent:t.parentNode,next:t.nextSibling,cssText:t.style.cssText,className:t.className,sx:window.pageXOffset,sy:window.pageYOffset},window.location.href=window.location.href.toString()+fshash;for(var n=document.body.childNodes,o=0;o<n.length;++o)"DIV"==n[o].tagName&&(n[o].normal_display=n[o].style.display,n[o].style.display="none")}$(t).hide(),t.className="",$(t).css({position:"fixed",top:0,left:0,zIndex:9999999,width:"100%",height:"100%"}),document.body.insertBefore(t,document.body.firstChild),window.scrollTo(0,0)}else{$(t).hide();var i=toggleFS;t.style.cssText=i.cssText,t.className=i.className,i.parent.insertBefore(t,i.next);for(n=document.body.childNodes,o=0;o<n.length;++o)void 0!==n[o].normal_display&&(n[o].style.display=n[o].normal_display);window.scrollTo(i.sx,i.sy),toggleFS=null}chk=document.getElementById("fullscreenchk"),chk.src=null==toggleFS?"http://ropewiki.com/images/b/b9/FullscreenIcon.png":"http://ropewiki.com/images/9/92/SmallscreenIcon.png",chk.onclick=null==toggleFS?toggleFullScreen:backFullScreen,mapcover(),$(t).show(),centermap()}}$(window).on("hashchange",function(){null!=toggleFS&&window.location.href.toString().indexOf(fshash)<0&&toggleFullScreen()});var clistcookie="regionlist",CollapsibleLists=new function(){function p(n){return function(e){var t=(e=e||window.event).target?e.target:e.srcElement;"LI"==t.nodeName&&t==n&&g(n)}}function g(e){for(var t=e.className.match(/(^| )collapsibleListClosed( |$)/),t=function(e,t){var n=null,o=e.getElementsByTagName("a");0==o.length&&(o=e.getElementsByTagName("span"));0<o.length&&(n=o[0].innerHTML);if(!n)return t;{if(n="<"+n+">",null!=clistloading)return 0<=clistloading.indexOf(n);var i=getCookie(clistcookie);i=i.split(n).join(""),t&&(i+=n),setCookie(clistcookie,i)}return t}(e,t),n=e.getElementsByTagName("ul"),o=0;o<n.length;o++){for(var i,a=n[o];"LI"!=a.nodeName;)a=a.parentNode;a==e&&(n[o].style.display=t?"block":"none",t&&(i=[],function e(t,n){for(var o=0;o<t.childNodes.length;++o){var i=t.childNodes[o];i.style&&"none"!=i.style.display&&(n.length<30&&i.className&&0<=i.className.indexOf("regioncount")&&($(i).removeClass("regioncount"),n.push(i)),0<i.childNodes.length&&"LI"==i.tagName&&e(i,n))}}(n[o],i),function(o){for(var e=[],t=0;t<o.length;++t){var n="NOTEXIST",i=o[t].getElementsByTagName("A");i&&0<i.length&&(n=i[0].title),e.push(n)}var a="http://ropewiki.com/index.php?title=Template:RegionCount&action=raw&templates=expand&ctype=text/x-wiki&region="+urlencode(e.join(";"));$.get(geturl(a),function(e){for(var t=e.split(";"),n=0;n<o.length;++n)o[n].innerHTML=o[n].innerHTML+" "+t[n]})}(i)))}e.className=e.className.replace(/(^| )collapsibleList(Open|Closed)( |$)/,""),0<n.length&&(e.className+=" collapsibleList"+(t?"Open":"Closed"))}this.apply=function(e){clistloading=(clistloading=getCookie(clistcookie))||"<World>";for(var t=document.getElementsByTagName("ul"),n=0;n<t.length;n++)if(t[n].className.match(/(^| )collapsibleList( |$)/)&&(this.applyTo(t[n],!0),!e))for(var o=t[n].getElementsByTagName("ul"),i=0;i<o.length;i++)o[i].className+=" collapsibleList";clistloading=null},this.applyTo=function(e,t){var n;0==(d=e.getElementsByTagName(n="A")).length&&(d=e.getElementsByTagName(n="SPAN"));for(var o=[],i=[],a=0;a<d.length;a++)o.push(d[a]);for(a=0;a<o.length;a++){var l=-1;if("A"==n?(l=i.indexOf(o[a].href),i.push(o[a].href)):(l=i.indexOf(o[a].innerHTML),i.push(o[a].innerHTML)),!(l<0)){for(var r=o[a];r&&"LI"!=r.tagName;)r=r.parentNode;for(var s=r.getElementsByTagName("UL"),c=o[l];c&&"LI"!=c.tagName;)c=c.parentNode;var m=c.getElementsByTagName("UL");0<s.length&&0==m.length?c.appendChild(s[0].cloneNode(!0)):0<m.length&&0==s.length&&r.appendChild(m[0].cloneNode(!0))}}for(var d=e.getElementsByTagName("li"),a=0;a<d.length;a++)t&&e!=d[a].parentNode||(d[a].addEventListener?d[a].addEventListener("mousedown",function(e){e.preventDefault()},!1):d[a].attachEvent("onselectstart",function(){event.returnValue=!1}),d[a].addEventListener?d[a].addEventListener("click",p(d[a]),!1):d[a].attachEvent("onclick",p(d[a])),g(d[a]))}},sites=[];function findsite(e){for(var t=0;t<sites.length;t++)if(sites[t].id==e)return sites[t];return null}function nonamespace(e){return e.replace("Events:","")}function sitelink(e,t,n){var o,i;return void 0!==n||(o=findsite(n=e))&&(i=e.split(":")[1],n=o.urls[0].replace("%id",i)),""==n?'<span style="color:#808080">'+t+"</span>":aref(n,t,t,'target="_blank"')}var currenturl=window.location.href.toString();function isAndroid(){return"undefined"!=typeof Android||""!=urlget(currenturl,"debugandroid","")}function kmlurl(e){if("undefined"!=typeof Android)return Android.kmlurl(e);return"http://d5a.net/rwr?gpx=off&kml=http://ropewiki.com/KMLList?action=raw&templates=expand&ctype=application/x-zope-edit&group=link&query=%5B%5BCategory%3ACanyons%5D%5D%5B%5BLocated%20in%20region.Located%20in%20regions%3A%3AX%7C%7CSan%20Diego%5D%5D&sort=&order=ascending&more=&num=on&ext=.kml"}function viewsize(){var e=0;return"undefined"!=typeof Android&&(e=Android.isWebView()-10),e<=0&&(e=600),e}function WebViewStyle(){if(isAndroid()){for(var e=" .noprint, .gmnoprint, .rwSort, #contentSub, #top, #mw-head-base, #mw-page-base, #mw-navigation, #footer, .popupformlink, .toc, .mw-editsection ",t=" .mw-body { margin:0px !important; padding:5px !important; } body { margin:0px !important; padding:0px !important; }",n=document.getElementsByClassName("pinmap"),o=0,i=1;o<n.length;++o,++i){var a=i.toString();a.length<2&&(a="0"+a);var l="#"+a+" "+n[o].innerHTML;n[o].innerHTML=l}document.getElementById("kmltitle")&&(e+=" #firstHeading ",t+=" .kmlmapdisplay { width:"+(r=viewsize())+"px !important; height:"+r+"px !important; }");var r,s=document.getElementById("kmlsummary");s&&(e+=" #firstHeading, #displaysummary, ",t+=" #mapbox { width:"+(r=viewsize())+"px !important; height:"+r+"px !important; }"),0<$(".tableregion td big").length&&$("#firstHeading").text($(".tableregion td big").text()),$(".tableregion").remove();var c,m=document.getElementById("mapmenu");m&&(psum=$('a:contains("Printable Summary")'),pmap=$('a[href*="/Map?pagename"]'),c=[],s?c.push('<a class="button-link" href="'+kmlurl(window.location.href.toString())+'">Open KML</a>'):0<psum.length?($("#mapbox").remove(),c.push('<a class="button-link" href="'+psum[0].href+'">View Map</a>'),c.push('<a class="button-link" href="'+kmlurl(psum[0].href)+'">Open KML</a>')):0<pmap.length&&($("#kmlmapdisplay").remove(),elem=$('a:contains("Download KML")'),0<elem.length&&(c.push('<a class="button-link" href="'+pmap[0].href+'">View Map</a>'),c.push('<a class="button-link" href="'+elem[0].href+'">Open KML</a>'))),m.innerHTML=c.join(" "));for(var d=e.split(",").join(" ").split(" "),o=0;o<d.length;++o)0<d[o].length&&$(d[o]).remove();var p=document.createElement("style");p.id="androidstyle",p.innerHTML=t,document.body.appendChild(p)}}function loadEditor(){}var tb=document.getElementById("toolbar");tb||(tb=document.createElement("DIV"),tb.id="toolbar");for(var first=null,prefix="_section",list=document.getElementsByTagName("TEXTAREA"),i=0;i<list.length;++i)list[i].name&&list[i].name.substr(0,prefix.length)==prefix&&(first=first||list[i],list[i].onfocus=function(){this.parentNode.insertBefore(tb,this)});first&&first.parentNode.insertBefore(tb,first),window.mw&&mw&&mw.loader.using("mediawiki.action.edit",function(){var e=document.getElementById("toolbar");e&&(e.innerHTML=""),mw.toolbar.addButton(!1,"Bold text","'''","'''","Bold text","mw-editbutton-bold"),mw.toolbar.addButton(!1,"Italic text","''","''","Italic text","mw-editbutton-italic"),mw.toolbar.addButton({imageFile:"http://ropewiki.com/images/0/01/BulletlistIcon.png",speedTip:"Bulleted list",tagOpen:"* ",tagClose:"",sampleText:"Bulleted list item",imageId:"button-bullet"}),mw.toolbar.addButton({imageFile:"http://ropewiki.com/images/4/45/Galleryicon1.png",speedTip:"Insert a picture (.jpg .gif .png .pdf)",tagOpen:"{{pic|",tagClose:"}}",sampleText:"name.jpg ~ caption",imageId:"button-pic1"}),mw.toolbar.addButton({imageFile:"http://ropewiki.com/images/d/d4/Galleryiconn.png",speedTip:"Insert a picture gallery (.jpg .gif .png .pdf)",tagOpen:"{{pic|",tagClose:"}}",sampleText:"pic1.jpg ~ caption1 ; pic2.jpg ~ caption2 ; pic3.jpg ~ caption3",imageId:"button-picn"}),mw.toolbar.addButton({imageFile:"http://ropewiki.com/images/c/ca/Galleryiconx.png",speedTip:"Insert a large sketch or document (.pdf .gif .png .jpg)",tagOpen:"{{pic|size=X|",tagClose:"}}",sampleText:"sketch.pdf ~ caption",imageId:"button-picx"}),mw.toolbar.addButton(!1,"Internal link","[[","]]","Link title","mw-editbutton-link"),mw.toolbar.addButton(!1,"External link (remember http:// prefix)","[","]","http://www.example.com link title","mw-editbutton-extlink"),mw.toolbar.addButton(!1,"Level 2 headline","\n=== "," ===\n","Headline text","mw-editbutton-headline"),mw.toolbar.addButton(!1,"Ignore wiki formatting","<nowiki>","</nowiki>","Insert non-formatted text here","mw-editbutton-nowiki"),mw.toolbar.addButton(!1,"Your signature with timestamp","--[[User:BetaRobot2|BetaRobot2]] ([[User talk:BetaRobot2|talk]]) 17:01, 11 June 2016 (EDT)","","","mw-editbutton-signature"),mw.toolbar.addButton(!1,"Horizontal line (use sparingly)","\n----\n","","","mw-editbutton-hr"),$(function(){mw.toolbar.init()})});var customizeToolbar=function(){console.log("customizeToolbar"),$("#wpTextbox1").wikiEditor("addToToolbar",{section:"main",group:"format",tools:{bullist:{label:"Bulleted list",type:"button",icon:"http://ropewiki.com/images/0/01/BulletlistIcon.png",action:{type:"encapsulate",options:{pre:"* ",peri:"Bulleted list item",post:""}}}}}),$("#wpTextbox1").wikiEditor("addToToolbar",{section:"main",group:"format",tools:{pic1:{label:"Insert a picture (.jpg .gif .png .pdf)",type:"button",icon:"http://ropewiki.com/images/4/45/Galleryicon1.png",action:{type:"encapsulate",options:{pre:"{{pic|",peri:"name.jpg ~ caption",post:"}}"}}}}}),$("#wpTextbox1").wikiEditor("addToToolbar",{section:"main",group:"format",tools:{picn:{label:"Insert a picture gallery (.jpg .gif .png .pdf)",type:"button",icon:"http://ropewiki.com/images/d/d4/Galleryiconn.png",action:{type:"encapsulate",options:{pre:"{{pic|",peri:"pic1.jpg ~ caption1 ; pic2.jpg ~ caption2 ; pic3.jpg ~ caption3",post:"}}"}}}}}),$("#wpTextbox1").wikiEditor("addToToolbar",{section:"main",group:"format",tools:{picx:{label:"Insert a large sketch or document (.pdf .gif .png .jpg)",type:"button",icon:"http://ropewiki.com/images/c/ca/Galleryiconx.png",action:{type:"encapsulate",options:{pre:"{{pic|size=X|",peri:"sketch.pdf ~ caption",post:"}}"}}}}}),$("#wpTextbox1, .wikieditor").wikiEditor("removeFromToolbar",{section:"advanced",group:"insert",tool:"gallery"})};function loadFacebook(){}"undefined"!=typeof mw&&mw&&-1!==$.inArray(mw.config.get("wgAction"),["edit","submit"])&&(mw.loader.using("user.options",function(){1==mw.user.options.get("usebetatoolbar")&&$.when(mw.loader.using("ext.wikiEditor.toolbar"),$.ready).then(customizeToolbar)}),mw.hook("ext.lqt.textareaCreated").add(customizeToolbar)),$(function(){for(var e=document.getElementsByClassName("mw-popout-link"),t=0;t<e.length;t++){var n=e[t].innerText,o=n.indexOf(" "),i=o<0?n:n.substring(0,o),a=o<0?i:n.substring(o+1);e[t].innerHTML='<a href="'+i+'" target="_blank">'+a+"</a>"}}());